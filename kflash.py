#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import sys
import time
import zlib
import copy
import struct
from enum import Enum
import binascii
import hashlib
import argparse
import math
import zipfile, tempfile
import json
import re
import os

BASH_TIPS = dict(NORMAL='\033[0m',BOLD='\033[1m',DIM='\033[2m',UNDERLINE='\033[4m',
                    DEFAULT='\033[0m', RED='\033[31m', YELLOW='\033[33m', GREEN='\033[32m',
                    BG_DEFAULT='\033[49m', BG_WHITE='\033[107m')

ERROR_MSG   = BASH_TIPS['RED']+BASH_TIPS['BOLD']+'[ERROR]'+BASH_TIPS['NORMAL']
WARN_MSG    = BASH_TIPS['YELLOW']+BASH_TIPS['BOLD']+'[WARN]'+BASH_TIPS['NORMAL']
INFO_MSG    = BASH_TIPS['GREEN']+BASH_TIPS['BOLD']+'[INFO]'+BASH_TIPS['NORMAL']

VID_LIST_FOR_AUTO_LOOKUP = "(1A86)|(0403)|(067B)|(10C4)|(C251)|(0403)"
#                            WCH    FTDI    PL     CL    DAP   OPENEC
timeout = 0.5

MAX_RETRY_TIMES = 10

class TimeoutError(Exception): pass

try:
    import serial
    import serial.tools.list_ports
except ImportError:
    print(ERROR_MSG,'PySerial must be installed, run '+BASH_TIPS['GREEN']+'`pip3 install pyserial`',BASH_TIPS['DEFAULT'])
    sys.exit(1)

# AES is from: https://github.com/ricmoo/pyaes, Copyright by Richard Moore
class AES:
    '''Encapsulates the AES block cipher.
    You generally should not need this. Use the AESModeOfOperation classes
    below instead.'''
    @staticmethod
    def _compact_word(word):
        return (word[0] << 24) | (word[1] << 16) | (word[2] << 8) | word[3]

    # Number of rounds by keysize
    number_of_rounds = {16: 10, 24: 12, 32: 14}

    # Round constant words
    rcon = [ 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91 ]

    # S-box and Inverse S-box (S is for Substitution)
    S = [ 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16 ]
    Si =[ 0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb, 0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb, 0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e, 0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d ]

    # Transformations for encryption
    T1 = [ 0xc66363a5, 0xf87c7c84, 0xee777799, 0xf67b7b8d, 0xfff2f20d, 0xd66b6bbd, 0xde6f6fb1, 0x91c5c554, 0x60303050, 0x02010103, 0xce6767a9, 0x562b2b7d, 0xe7fefe19, 0xb5d7d762, 0x4dababe6, 0xec76769a, 0x8fcaca45, 0x1f82829d, 0x89c9c940, 0xfa7d7d87, 0xeffafa15, 0xb25959eb, 0x8e4747c9, 0xfbf0f00b, 0x41adadec, 0xb3d4d467, 0x5fa2a2fd, 0x45afafea, 0x239c9cbf, 0x53a4a4f7, 0xe4727296, 0x9bc0c05b, 0x75b7b7c2, 0xe1fdfd1c, 0x3d9393ae, 0x4c26266a, 0x6c36365a, 0x7e3f3f41, 0xf5f7f702, 0x83cccc4f, 0x6834345c, 0x51a5a5f4, 0xd1e5e534, 0xf9f1f108, 0xe2717193, 0xabd8d873, 0x62313153, 0x2a15153f, 0x0804040c, 0x95c7c752, 0x46232365, 0x9dc3c35e, 0x30181828, 0x379696a1, 0x0a05050f, 0x2f9a9ab5, 0x0e070709, 0x24121236, 0x1b80809b, 0xdfe2e23d, 0xcdebeb26, 0x4e272769, 0x7fb2b2cd, 0xea75759f, 0x1209091b, 0x1d83839e, 0x582c2c74, 0x341a1a2e, 0x361b1b2d, 0xdc6e6eb2, 0xb45a5aee, 0x5ba0a0fb, 0xa45252f6, 0x763b3b4d, 0xb7d6d661, 0x7db3b3ce, 0x5229297b, 0xdde3e33e, 0x5e2f2f71, 0x13848497, 0xa65353f5, 0xb9d1d168, 0x00000000, 0xc1eded2c, 0x40202060, 0xe3fcfc1f, 0x79b1b1c8, 0xb65b5bed, 0xd46a6abe, 0x8dcbcb46, 0x67bebed9, 0x7239394b, 0x944a4ade, 0x984c4cd4, 0xb05858e8, 0x85cfcf4a, 0xbbd0d06b, 0xc5efef2a, 0x4faaaae5, 0xedfbfb16, 0x864343c5, 0x9a4d4dd7, 0x66333355, 0x11858594, 0x8a4545cf, 0xe9f9f910, 0x04020206, 0xfe7f7f81, 0xa05050f0, 0x783c3c44, 0x259f9fba, 0x4ba8a8e3, 0xa25151f3, 0x5da3a3fe, 0x804040c0, 0x058f8f8a, 0x3f9292ad, 0x219d9dbc, 0x70383848, 0xf1f5f504, 0x63bcbcdf, 0x77b6b6c1, 0xafdada75, 0x42212163, 0x20101030, 0xe5ffff1a, 0xfdf3f30e, 0xbfd2d26d, 0x81cdcd4c, 0x180c0c14, 0x26131335, 0xc3ecec2f, 0xbe5f5fe1, 0x359797a2, 0x884444cc, 0x2e171739, 0x93c4c457, 0x55a7a7f2, 0xfc7e7e82, 0x7a3d3d47, 0xc86464ac, 0xba5d5de7, 0x3219192b, 0xe6737395, 0xc06060a0, 0x19818198, 0x9e4f4fd1, 0xa3dcdc7f, 0x44222266, 0x542a2a7e, 0x3b9090ab, 0x0b888883, 0x8c4646ca, 0xc7eeee29, 0x6bb8b8d3, 0x2814143c, 0xa7dede79, 0xbc5e5ee2, 0x160b0b1d, 0xaddbdb76, 0xdbe0e03b, 0x64323256, 0x743a3a4e, 0x140a0a1e, 0x924949db, 0x0c06060a, 0x4824246c, 0xb85c5ce4, 0x9fc2c25d, 0xbdd3d36e, 0x43acacef, 0xc46262a6, 0x399191a8, 0x319595a4, 0xd3e4e437, 0xf279798b, 0xd5e7e732, 0x8bc8c843, 0x6e373759, 0xda6d6db7, 0x018d8d8c, 0xb1d5d564, 0x9c4e4ed2, 0x49a9a9e0, 0xd86c6cb4, 0xac5656fa, 0xf3f4f407, 0xcfeaea25, 0xca6565af, 0xf47a7a8e, 0x47aeaee9, 0x10080818, 0x6fbabad5, 0xf0787888, 0x4a25256f, 0x5c2e2e72, 0x381c1c24, 0x57a6a6f1, 0x73b4b4c7, 0x97c6c651, 0xcbe8e823, 0xa1dddd7c, 0xe874749c, 0x3e1f1f21, 0x964b4bdd, 0x61bdbddc, 0x0d8b8b86, 0x0f8a8a85, 0xe0707090, 0x7c3e3e42, 0x71b5b5c4, 0xcc6666aa, 0x904848d8, 0x06030305, 0xf7f6f601, 0x1c0e0e12, 0xc26161a3, 0x6a35355f, 0xae5757f9, 0x69b9b9d0, 0x17868691, 0x99c1c158, 0x3a1d1d27, 0x279e9eb9, 0xd9e1e138, 0xebf8f813, 0x2b9898b3, 0x22111133, 0xd26969bb, 0xa9d9d970, 0x078e8e89, 0x339494a7, 0x2d9b9bb6, 0x3c1e1e22, 0x15878792, 0xc9e9e920, 0x87cece49, 0xaa5555ff, 0x50282878, 0xa5dfdf7a, 0x038c8c8f, 0x59a1a1f8, 0x09898980, 0x1a0d0d17, 0x65bfbfda, 0xd7e6e631, 0x844242c6, 0xd06868b8, 0x824141c3, 0x299999b0, 0x5a2d2d77, 0x1e0f0f11, 0x7bb0b0cb, 0xa85454fc, 0x6dbbbbd6, 0x2c16163a ]
    T2 = [ 0xa5c66363, 0x84f87c7c, 0x99ee7777, 0x8df67b7b, 0x0dfff2f2, 0xbdd66b6b, 0xb1de6f6f, 0x5491c5c5, 0x50603030, 0x03020101, 0xa9ce6767, 0x7d562b2b, 0x19e7fefe, 0x62b5d7d7, 0xe64dabab, 0x9aec7676, 0x458fcaca, 0x9d1f8282, 0x4089c9c9, 0x87fa7d7d, 0x15effafa, 0xebb25959, 0xc98e4747, 0x0bfbf0f0, 0xec41adad, 0x67b3d4d4, 0xfd5fa2a2, 0xea45afaf, 0xbf239c9c, 0xf753a4a4, 0x96e47272, 0x5b9bc0c0, 0xc275b7b7, 0x1ce1fdfd, 0xae3d9393, 0x6a4c2626, 0x5a6c3636, 0x417e3f3f, 0x02f5f7f7, 0x4f83cccc, 0x5c683434, 0xf451a5a5, 0x34d1e5e5, 0x08f9f1f1, 0x93e27171, 0x73abd8d8, 0x53623131, 0x3f2a1515, 0x0c080404, 0x5295c7c7, 0x65462323, 0x5e9dc3c3, 0x28301818, 0xa1379696, 0x0f0a0505, 0xb52f9a9a, 0x090e0707, 0x36241212, 0x9b1b8080, 0x3ddfe2e2, 0x26cdebeb, 0x694e2727, 0xcd7fb2b2, 0x9fea7575, 0x1b120909, 0x9e1d8383, 0x74582c2c, 0x2e341a1a, 0x2d361b1b, 0xb2dc6e6e, 0xeeb45a5a, 0xfb5ba0a0, 0xf6a45252, 0x4d763b3b, 0x61b7d6d6, 0xce7db3b3, 0x7b522929, 0x3edde3e3, 0x715e2f2f, 0x97138484, 0xf5a65353, 0x68b9d1d1, 0x00000000, 0x2cc1eded, 0x60402020, 0x1fe3fcfc, 0xc879b1b1, 0xedb65b5b, 0xbed46a6a, 0x468dcbcb, 0xd967bebe, 0x4b723939, 0xde944a4a, 0xd4984c4c, 0xe8b05858, 0x4a85cfcf, 0x6bbbd0d0, 0x2ac5efef, 0xe54faaaa, 0x16edfbfb, 0xc5864343, 0xd79a4d4d, 0x55663333, 0x94118585, 0xcf8a4545, 0x10e9f9f9, 0x06040202, 0x81fe7f7f, 0xf0a05050, 0x44783c3c, 0xba259f9f, 0xe34ba8a8, 0xf3a25151, 0xfe5da3a3, 0xc0804040, 0x8a058f8f, 0xad3f9292, 0xbc219d9d, 0x48703838, 0x04f1f5f5, 0xdf63bcbc, 0xc177b6b6, 0x75afdada, 0x63422121, 0x30201010, 0x1ae5ffff, 0x0efdf3f3, 0x6dbfd2d2, 0x4c81cdcd, 0x14180c0c, 0x35261313, 0x2fc3ecec, 0xe1be5f5f, 0xa2359797, 0xcc884444, 0x392e1717, 0x5793c4c4, 0xf255a7a7, 0x82fc7e7e, 0x477a3d3d, 0xacc86464, 0xe7ba5d5d, 0x2b321919, 0x95e67373, 0xa0c06060, 0x98198181, 0xd19e4f4f, 0x7fa3dcdc, 0x66442222, 0x7e542a2a, 0xab3b9090, 0x830b8888, 0xca8c4646, 0x29c7eeee, 0xd36bb8b8, 0x3c281414, 0x79a7dede, 0xe2bc5e5e, 0x1d160b0b, 0x76addbdb, 0x3bdbe0e0, 0x56643232, 0x4e743a3a, 0x1e140a0a, 0xdb924949, 0x0a0c0606, 0x6c482424, 0xe4b85c5c, 0x5d9fc2c2, 0x6ebdd3d3, 0xef43acac, 0xa6c46262, 0xa8399191, 0xa4319595, 0x37d3e4e4, 0x8bf27979, 0x32d5e7e7, 0x438bc8c8, 0x596e3737, 0xb7da6d6d, 0x8c018d8d, 0x64b1d5d5, 0xd29c4e4e, 0xe049a9a9, 0xb4d86c6c, 0xfaac5656, 0x07f3f4f4, 0x25cfeaea, 0xafca6565, 0x8ef47a7a, 0xe947aeae, 0x18100808, 0xd56fbaba, 0x88f07878, 0x6f4a2525, 0x725c2e2e, 0x24381c1c, 0xf157a6a6, 0xc773b4b4, 0x5197c6c6, 0x23cbe8e8, 0x7ca1dddd, 0x9ce87474, 0x213e1f1f, 0xdd964b4b, 0xdc61bdbd, 0x860d8b8b, 0x850f8a8a, 0x90e07070, 0x427c3e3e, 0xc471b5b5, 0xaacc6666, 0xd8904848, 0x05060303, 0x01f7f6f6, 0x121c0e0e, 0xa3c26161, 0x5f6a3535, 0xf9ae5757, 0xd069b9b9, 0x91178686, 0x5899c1c1, 0x273a1d1d, 0xb9279e9e, 0x38d9e1e1, 0x13ebf8f8, 0xb32b9898, 0x33221111, 0xbbd26969, 0x70a9d9d9, 0x89078e8e, 0xa7339494, 0xb62d9b9b, 0x223c1e1e, 0x92158787, 0x20c9e9e9, 0x4987cece, 0xffaa5555, 0x78502828, 0x7aa5dfdf, 0x8f038c8c, 0xf859a1a1, 0x80098989, 0x171a0d0d, 0xda65bfbf, 0x31d7e6e6, 0xc6844242, 0xb8d06868, 0xc3824141, 0xb0299999, 0x775a2d2d, 0x111e0f0f, 0xcb7bb0b0, 0xfca85454, 0xd66dbbbb, 0x3a2c1616 ]
    T3 = [ 0x63a5c663, 0x7c84f87c, 0x7799ee77, 0x7b8df67b, 0xf20dfff2, 0x6bbdd66b, 0x6fb1de6f, 0xc55491c5, 0x30506030, 0x01030201, 0x67a9ce67, 0x2b7d562b, 0xfe19e7fe, 0xd762b5d7, 0xabe64dab, 0x769aec76, 0xca458fca, 0x829d1f82, 0xc94089c9, 0x7d87fa7d, 0xfa15effa, 0x59ebb259, 0x47c98e47, 0xf00bfbf0, 0xadec41ad, 0xd467b3d4, 0xa2fd5fa2, 0xafea45af, 0x9cbf239c, 0xa4f753a4, 0x7296e472, 0xc05b9bc0, 0xb7c275b7, 0xfd1ce1fd, 0x93ae3d93, 0x266a4c26, 0x365a6c36, 0x3f417e3f, 0xf702f5f7, 0xcc4f83cc, 0x345c6834, 0xa5f451a5, 0xe534d1e5, 0xf108f9f1, 0x7193e271, 0xd873abd8, 0x31536231, 0x153f2a15, 0x040c0804, 0xc75295c7, 0x23654623, 0xc35e9dc3, 0x18283018, 0x96a13796, 0x050f0a05, 0x9ab52f9a, 0x07090e07, 0x12362412, 0x809b1b80, 0xe23ddfe2, 0xeb26cdeb, 0x27694e27, 0xb2cd7fb2, 0x759fea75, 0x091b1209, 0x839e1d83, 0x2c74582c, 0x1a2e341a, 0x1b2d361b, 0x6eb2dc6e, 0x5aeeb45a, 0xa0fb5ba0, 0x52f6a452, 0x3b4d763b, 0xd661b7d6, 0xb3ce7db3, 0x297b5229, 0xe33edde3, 0x2f715e2f, 0x84971384, 0x53f5a653, 0xd168b9d1, 0x00000000, 0xed2cc1ed, 0x20604020, 0xfc1fe3fc, 0xb1c879b1, 0x5bedb65b, 0x6abed46a, 0xcb468dcb, 0xbed967be, 0x394b7239, 0x4ade944a, 0x4cd4984c, 0x58e8b058, 0xcf4a85cf, 0xd06bbbd0, 0xef2ac5ef, 0xaae54faa, 0xfb16edfb, 0x43c58643, 0x4dd79a4d, 0x33556633, 0x85941185, 0x45cf8a45, 0xf910e9f9, 0x02060402, 0x7f81fe7f, 0x50f0a050, 0x3c44783c, 0x9fba259f, 0xa8e34ba8, 0x51f3a251, 0xa3fe5da3, 0x40c08040, 0x8f8a058f, 0x92ad3f92, 0x9dbc219d, 0x38487038, 0xf504f1f5, 0xbcdf63bc, 0xb6c177b6, 0xda75afda, 0x21634221, 0x10302010, 0xff1ae5ff, 0xf30efdf3, 0xd26dbfd2, 0xcd4c81cd, 0x0c14180c, 0x13352613, 0xec2fc3ec, 0x5fe1be5f, 0x97a23597, 0x44cc8844, 0x17392e17, 0xc45793c4, 0xa7f255a7, 0x7e82fc7e, 0x3d477a3d, 0x64acc864, 0x5de7ba5d, 0x192b3219, 0x7395e673, 0x60a0c060, 0x81981981, 0x4fd19e4f, 0xdc7fa3dc, 0x22664422, 0x2a7e542a, 0x90ab3b90, 0x88830b88, 0x46ca8c46, 0xee29c7ee, 0xb8d36bb8, 0x143c2814, 0xde79a7de, 0x5ee2bc5e, 0x0b1d160b, 0xdb76addb, 0xe03bdbe0, 0x32566432, 0x3a4e743a, 0x0a1e140a, 0x49db9249, 0x060a0c06, 0x246c4824, 0x5ce4b85c, 0xc25d9fc2, 0xd36ebdd3, 0xacef43ac, 0x62a6c462, 0x91a83991, 0x95a43195, 0xe437d3e4, 0x798bf279, 0xe732d5e7, 0xc8438bc8, 0x37596e37, 0x6db7da6d, 0x8d8c018d, 0xd564b1d5, 0x4ed29c4e, 0xa9e049a9, 0x6cb4d86c, 0x56faac56, 0xf407f3f4, 0xea25cfea, 0x65afca65, 0x7a8ef47a, 0xaee947ae, 0x08181008, 0xbad56fba, 0x7888f078, 0x256f4a25, 0x2e725c2e, 0x1c24381c, 0xa6f157a6, 0xb4c773b4, 0xc65197c6, 0xe823cbe8, 0xdd7ca1dd, 0x749ce874, 0x1f213e1f, 0x4bdd964b, 0xbddc61bd, 0x8b860d8b, 0x8a850f8a, 0x7090e070, 0x3e427c3e, 0xb5c471b5, 0x66aacc66, 0x48d89048, 0x03050603, 0xf601f7f6, 0x0e121c0e, 0x61a3c261, 0x355f6a35, 0x57f9ae57, 0xb9d069b9, 0x86911786, 0xc15899c1, 0x1d273a1d, 0x9eb9279e, 0xe138d9e1, 0xf813ebf8, 0x98b32b98, 0x11332211, 0x69bbd269, 0xd970a9d9, 0x8e89078e, 0x94a73394, 0x9bb62d9b, 0x1e223c1e, 0x87921587, 0xe920c9e9, 0xce4987ce, 0x55ffaa55, 0x28785028, 0xdf7aa5df, 0x8c8f038c, 0xa1f859a1, 0x89800989, 0x0d171a0d, 0xbfda65bf, 0xe631d7e6, 0x42c68442, 0x68b8d068, 0x41c38241, 0x99b02999, 0x2d775a2d, 0x0f111e0f, 0xb0cb7bb0, 0x54fca854, 0xbbd66dbb, 0x163a2c16 ]
    T4 = [ 0x6363a5c6, 0x7c7c84f8, 0x777799ee, 0x7b7b8df6, 0xf2f20dff, 0x6b6bbdd6, 0x6f6fb1de, 0xc5c55491, 0x30305060, 0x01010302, 0x6767a9ce, 0x2b2b7d56, 0xfefe19e7, 0xd7d762b5, 0xababe64d, 0x76769aec, 0xcaca458f, 0x82829d1f, 0xc9c94089, 0x7d7d87fa, 0xfafa15ef, 0x5959ebb2, 0x4747c98e, 0xf0f00bfb, 0xadadec41, 0xd4d467b3, 0xa2a2fd5f, 0xafafea45, 0x9c9cbf23, 0xa4a4f753, 0x727296e4, 0xc0c05b9b, 0xb7b7c275, 0xfdfd1ce1, 0x9393ae3d, 0x26266a4c, 0x36365a6c, 0x3f3f417e, 0xf7f702f5, 0xcccc4f83, 0x34345c68, 0xa5a5f451, 0xe5e534d1, 0xf1f108f9, 0x717193e2, 0xd8d873ab, 0x31315362, 0x15153f2a, 0x04040c08, 0xc7c75295, 0x23236546, 0xc3c35e9d, 0x18182830, 0x9696a137, 0x05050f0a, 0x9a9ab52f, 0x0707090e, 0x12123624, 0x80809b1b, 0xe2e23ddf, 0xebeb26cd, 0x2727694e, 0xb2b2cd7f, 0x75759fea, 0x09091b12, 0x83839e1d, 0x2c2c7458, 0x1a1a2e34, 0x1b1b2d36, 0x6e6eb2dc, 0x5a5aeeb4, 0xa0a0fb5b, 0x5252f6a4, 0x3b3b4d76, 0xd6d661b7, 0xb3b3ce7d, 0x29297b52, 0xe3e33edd, 0x2f2f715e, 0x84849713, 0x5353f5a6, 0xd1d168b9, 0x00000000, 0xeded2cc1, 0x20206040, 0xfcfc1fe3, 0xb1b1c879, 0x5b5bedb6, 0x6a6abed4, 0xcbcb468d, 0xbebed967, 0x39394b72, 0x4a4ade94, 0x4c4cd498, 0x5858e8b0, 0xcfcf4a85, 0xd0d06bbb, 0xefef2ac5, 0xaaaae54f, 0xfbfb16ed, 0x4343c586, 0x4d4dd79a, 0x33335566, 0x85859411, 0x4545cf8a, 0xf9f910e9, 0x02020604, 0x7f7f81fe, 0x5050f0a0, 0x3c3c4478, 0x9f9fba25, 0xa8a8e34b, 0x5151f3a2, 0xa3a3fe5d, 0x4040c080, 0x8f8f8a05, 0x9292ad3f, 0x9d9dbc21, 0x38384870, 0xf5f504f1, 0xbcbcdf63, 0xb6b6c177, 0xdada75af, 0x21216342, 0x10103020, 0xffff1ae5, 0xf3f30efd, 0xd2d26dbf, 0xcdcd4c81, 0x0c0c1418, 0x13133526, 0xecec2fc3, 0x5f5fe1be, 0x9797a235, 0x4444cc88, 0x1717392e, 0xc4c45793, 0xa7a7f255, 0x7e7e82fc, 0x3d3d477a, 0x6464acc8, 0x5d5de7ba, 0x19192b32, 0x737395e6, 0x6060a0c0, 0x81819819, 0x4f4fd19e, 0xdcdc7fa3, 0x22226644, 0x2a2a7e54, 0x9090ab3b, 0x8888830b, 0x4646ca8c, 0xeeee29c7, 0xb8b8d36b, 0x14143c28, 0xdede79a7, 0x5e5ee2bc, 0x0b0b1d16, 0xdbdb76ad, 0xe0e03bdb, 0x32325664, 0x3a3a4e74, 0x0a0a1e14, 0x4949db92, 0x06060a0c, 0x24246c48, 0x5c5ce4b8, 0xc2c25d9f, 0xd3d36ebd, 0xacacef43, 0x6262a6c4, 0x9191a839, 0x9595a431, 0xe4e437d3, 0x79798bf2, 0xe7e732d5, 0xc8c8438b, 0x3737596e, 0x6d6db7da, 0x8d8d8c01, 0xd5d564b1, 0x4e4ed29c, 0xa9a9e049, 0x6c6cb4d8, 0x5656faac, 0xf4f407f3, 0xeaea25cf, 0x6565afca, 0x7a7a8ef4, 0xaeaee947, 0x08081810, 0xbabad56f, 0x787888f0, 0x25256f4a, 0x2e2e725c, 0x1c1c2438, 0xa6a6f157, 0xb4b4c773, 0xc6c65197, 0xe8e823cb, 0xdddd7ca1, 0x74749ce8, 0x1f1f213e, 0x4b4bdd96, 0xbdbddc61, 0x8b8b860d, 0x8a8a850f, 0x707090e0, 0x3e3e427c, 0xb5b5c471, 0x6666aacc, 0x4848d890, 0x03030506, 0xf6f601f7, 0x0e0e121c, 0x6161a3c2, 0x35355f6a, 0x5757f9ae, 0xb9b9d069, 0x86869117, 0xc1c15899, 0x1d1d273a, 0x9e9eb927, 0xe1e138d9, 0xf8f813eb, 0x9898b32b, 0x11113322, 0x6969bbd2, 0xd9d970a9, 0x8e8e8907, 0x9494a733, 0x9b9bb62d, 0x1e1e223c, 0x87879215, 0xe9e920c9, 0xcece4987, 0x5555ffaa, 0x28287850, 0xdfdf7aa5, 0x8c8c8f03, 0xa1a1f859, 0x89898009, 0x0d0d171a, 0xbfbfda65, 0xe6e631d7, 0x4242c684, 0x6868b8d0, 0x4141c382, 0x9999b029, 0x2d2d775a, 0x0f0f111e, 0xb0b0cb7b, 0x5454fca8, 0xbbbbd66d, 0x16163a2c ]

    # Transformations for decryption
    T5 = [ 0x51f4a750, 0x7e416553, 0x1a17a4c3, 0x3a275e96, 0x3bab6bcb, 0x1f9d45f1, 0xacfa58ab, 0x4be30393, 0x2030fa55, 0xad766df6, 0x88cc7691, 0xf5024c25, 0x4fe5d7fc, 0xc52acbd7, 0x26354480, 0xb562a38f, 0xdeb15a49, 0x25ba1b67, 0x45ea0e98, 0x5dfec0e1, 0xc32f7502, 0x814cf012, 0x8d4697a3, 0x6bd3f9c6, 0x038f5fe7, 0x15929c95, 0xbf6d7aeb, 0x955259da, 0xd4be832d, 0x587421d3, 0x49e06929, 0x8ec9c844, 0x75c2896a, 0xf48e7978, 0x99583e6b, 0x27b971dd, 0xbee14fb6, 0xf088ad17, 0xc920ac66, 0x7dce3ab4, 0x63df4a18, 0xe51a3182, 0x97513360, 0x62537f45, 0xb16477e0, 0xbb6bae84, 0xfe81a01c, 0xf9082b94, 0x70486858, 0x8f45fd19, 0x94de6c87, 0x527bf8b7, 0xab73d323, 0x724b02e2, 0xe31f8f57, 0x6655ab2a, 0xb2eb2807, 0x2fb5c203, 0x86c57b9a, 0xd33708a5, 0x302887f2, 0x23bfa5b2, 0x02036aba, 0xed16825c, 0x8acf1c2b, 0xa779b492, 0xf307f2f0, 0x4e69e2a1, 0x65daf4cd, 0x0605bed5, 0xd134621f, 0xc4a6fe8a, 0x342e539d, 0xa2f355a0, 0x058ae132, 0xa4f6eb75, 0x0b83ec39, 0x4060efaa, 0x5e719f06, 0xbd6e1051, 0x3e218af9, 0x96dd063d, 0xdd3e05ae, 0x4de6bd46, 0x91548db5, 0x71c45d05, 0x0406d46f, 0x605015ff, 0x1998fb24, 0xd6bde997, 0x894043cc, 0x67d99e77, 0xb0e842bd, 0x07898b88, 0xe7195b38, 0x79c8eedb, 0xa17c0a47, 0x7c420fe9, 0xf8841ec9, 0x00000000, 0x09808683, 0x322bed48, 0x1e1170ac, 0x6c5a724e, 0xfd0efffb, 0x0f853856, 0x3daed51e, 0x362d3927, 0x0a0fd964, 0x685ca621, 0x9b5b54d1, 0x24362e3a, 0x0c0a67b1, 0x9357e70f, 0xb4ee96d2, 0x1b9b919e, 0x80c0c54f, 0x61dc20a2, 0x5a774b69, 0x1c121a16, 0xe293ba0a, 0xc0a02ae5, 0x3c22e043, 0x121b171d, 0x0e090d0b, 0xf28bc7ad, 0x2db6a8b9, 0x141ea9c8, 0x57f11985, 0xaf75074c, 0xee99ddbb, 0xa37f60fd, 0xf701269f, 0x5c72f5bc, 0x44663bc5, 0x5bfb7e34, 0x8b432976, 0xcb23c6dc, 0xb6edfc68, 0xb8e4f163, 0xd731dcca, 0x42638510, 0x13972240, 0x84c61120, 0x854a247d, 0xd2bb3df8, 0xaef93211, 0xc729a16d, 0x1d9e2f4b, 0xdcb230f3, 0x0d8652ec, 0x77c1e3d0, 0x2bb3166c, 0xa970b999, 0x119448fa, 0x47e96422, 0xa8fc8cc4, 0xa0f03f1a, 0x567d2cd8, 0x223390ef, 0x87494ec7, 0xd938d1c1, 0x8ccaa2fe, 0x98d40b36, 0xa6f581cf, 0xa57ade28, 0xdab78e26, 0x3fadbfa4, 0x2c3a9de4, 0x5078920d, 0x6a5fcc9b, 0x547e4662, 0xf68d13c2, 0x90d8b8e8, 0x2e39f75e, 0x82c3aff5, 0x9f5d80be, 0x69d0937c, 0x6fd52da9, 0xcf2512b3, 0xc8ac993b, 0x10187da7, 0xe89c636e, 0xdb3bbb7b, 0xcd267809, 0x6e5918f4, 0xec9ab701, 0x834f9aa8, 0xe6956e65, 0xaaffe67e, 0x21bccf08, 0xef15e8e6, 0xbae79bd9, 0x4a6f36ce, 0xea9f09d4, 0x29b07cd6, 0x31a4b2af, 0x2a3f2331, 0xc6a59430, 0x35a266c0, 0x744ebc37, 0xfc82caa6, 0xe090d0b0, 0x33a7d815, 0xf104984a, 0x41ecdaf7, 0x7fcd500e, 0x1791f62f, 0x764dd68d, 0x43efb04d, 0xccaa4d54, 0xe49604df, 0x9ed1b5e3, 0x4c6a881b, 0xc12c1fb8, 0x4665517f, 0x9d5eea04, 0x018c355d, 0xfa877473, 0xfb0b412e, 0xb3671d5a, 0x92dbd252, 0xe9105633, 0x6dd64713, 0x9ad7618c, 0x37a10c7a, 0x59f8148e, 0xeb133c89, 0xcea927ee, 0xb761c935, 0xe11ce5ed, 0x7a47b13c, 0x9cd2df59, 0x55f2733f, 0x1814ce79, 0x73c737bf, 0x53f7cdea, 0x5ffdaa5b, 0xdf3d6f14, 0x7844db86, 0xcaaff381, 0xb968c43e, 0x3824342c, 0xc2a3405f, 0x161dc372, 0xbce2250c, 0x283c498b, 0xff0d9541, 0x39a80171, 0x080cb3de, 0xd8b4e49c, 0x6456c190, 0x7bcb8461, 0xd532b670, 0x486c5c74, 0xd0b85742 ]
    T6 = [ 0x5051f4a7, 0x537e4165, 0xc31a17a4, 0x963a275e, 0xcb3bab6b, 0xf11f9d45, 0xabacfa58, 0x934be303, 0x552030fa, 0xf6ad766d, 0x9188cc76, 0x25f5024c, 0xfc4fe5d7, 0xd7c52acb, 0x80263544, 0x8fb562a3, 0x49deb15a, 0x6725ba1b, 0x9845ea0e, 0xe15dfec0, 0x02c32f75, 0x12814cf0, 0xa38d4697, 0xc66bd3f9, 0xe7038f5f, 0x9515929c, 0xebbf6d7a, 0xda955259, 0x2dd4be83, 0xd3587421, 0x2949e069, 0x448ec9c8, 0x6a75c289, 0x78f48e79, 0x6b99583e, 0xdd27b971, 0xb6bee14f, 0x17f088ad, 0x66c920ac, 0xb47dce3a, 0x1863df4a, 0x82e51a31, 0x60975133, 0x4562537f, 0xe0b16477, 0x84bb6bae, 0x1cfe81a0, 0x94f9082b, 0x58704868, 0x198f45fd, 0x8794de6c, 0xb7527bf8, 0x23ab73d3, 0xe2724b02, 0x57e31f8f, 0x2a6655ab, 0x07b2eb28, 0x032fb5c2, 0x9a86c57b, 0xa5d33708, 0xf2302887, 0xb223bfa5, 0xba02036a, 0x5ced1682, 0x2b8acf1c, 0x92a779b4, 0xf0f307f2, 0xa14e69e2, 0xcd65daf4, 0xd50605be, 0x1fd13462, 0x8ac4a6fe, 0x9d342e53, 0xa0a2f355, 0x32058ae1, 0x75a4f6eb, 0x390b83ec, 0xaa4060ef, 0x065e719f, 0x51bd6e10, 0xf93e218a, 0x3d96dd06, 0xaedd3e05, 0x464de6bd, 0xb591548d, 0x0571c45d, 0x6f0406d4, 0xff605015, 0x241998fb, 0x97d6bde9, 0xcc894043, 0x7767d99e, 0xbdb0e842, 0x8807898b, 0x38e7195b, 0xdb79c8ee, 0x47a17c0a, 0xe97c420f, 0xc9f8841e, 0x00000000, 0x83098086, 0x48322bed, 0xac1e1170, 0x4e6c5a72, 0xfbfd0eff, 0x560f8538, 0x1e3daed5, 0x27362d39, 0x640a0fd9, 0x21685ca6, 0xd19b5b54, 0x3a24362e, 0xb10c0a67, 0x0f9357e7, 0xd2b4ee96, 0x9e1b9b91, 0x4f80c0c5, 0xa261dc20, 0x695a774b, 0x161c121a, 0x0ae293ba, 0xe5c0a02a, 0x433c22e0, 0x1d121b17, 0x0b0e090d, 0xadf28bc7, 0xb92db6a8, 0xc8141ea9, 0x8557f119, 0x4caf7507, 0xbbee99dd, 0xfda37f60, 0x9ff70126, 0xbc5c72f5, 0xc544663b, 0x345bfb7e, 0x768b4329, 0xdccb23c6, 0x68b6edfc, 0x63b8e4f1, 0xcad731dc, 0x10426385, 0x40139722, 0x2084c611, 0x7d854a24, 0xf8d2bb3d, 0x11aef932, 0x6dc729a1, 0x4b1d9e2f, 0xf3dcb230, 0xec0d8652, 0xd077c1e3, 0x6c2bb316, 0x99a970b9, 0xfa119448, 0x2247e964, 0xc4a8fc8c, 0x1aa0f03f, 0xd8567d2c, 0xef223390, 0xc787494e, 0xc1d938d1, 0xfe8ccaa2, 0x3698d40b, 0xcfa6f581, 0x28a57ade, 0x26dab78e, 0xa43fadbf, 0xe42c3a9d, 0x0d507892, 0x9b6a5fcc, 0x62547e46, 0xc2f68d13, 0xe890d8b8, 0x5e2e39f7, 0xf582c3af, 0xbe9f5d80, 0x7c69d093, 0xa96fd52d, 0xb3cf2512, 0x3bc8ac99, 0xa710187d, 0x6ee89c63, 0x7bdb3bbb, 0x09cd2678, 0xf46e5918, 0x01ec9ab7, 0xa8834f9a, 0x65e6956e, 0x7eaaffe6, 0x0821bccf, 0xe6ef15e8, 0xd9bae79b, 0xce4a6f36, 0xd4ea9f09, 0xd629b07c, 0xaf31a4b2, 0x312a3f23, 0x30c6a594, 0xc035a266, 0x37744ebc, 0xa6fc82ca, 0xb0e090d0, 0x1533a7d8, 0x4af10498, 0xf741ecda, 0x0e7fcd50, 0x2f1791f6, 0x8d764dd6, 0x4d43efb0, 0x54ccaa4d, 0xdfe49604, 0xe39ed1b5, 0x1b4c6a88, 0xb8c12c1f, 0x7f466551, 0x049d5eea, 0x5d018c35, 0x73fa8774, 0x2efb0b41, 0x5ab3671d, 0x5292dbd2, 0x33e91056, 0x136dd647, 0x8c9ad761, 0x7a37a10c, 0x8e59f814, 0x89eb133c, 0xeecea927, 0x35b761c9, 0xede11ce5, 0x3c7a47b1, 0x599cd2df, 0x3f55f273, 0x791814ce, 0xbf73c737, 0xea53f7cd, 0x5b5ffdaa, 0x14df3d6f, 0x867844db, 0x81caaff3, 0x3eb968c4, 0x2c382434, 0x5fc2a340, 0x72161dc3, 0x0cbce225, 0x8b283c49, 0x41ff0d95, 0x7139a801, 0xde080cb3, 0x9cd8b4e4, 0x906456c1, 0x617bcb84, 0x70d532b6, 0x74486c5c, 0x42d0b857 ]
    T7 = [ 0xa75051f4, 0x65537e41, 0xa4c31a17, 0x5e963a27, 0x6bcb3bab, 0x45f11f9d, 0x58abacfa, 0x03934be3, 0xfa552030, 0x6df6ad76, 0x769188cc, 0x4c25f502, 0xd7fc4fe5, 0xcbd7c52a, 0x44802635, 0xa38fb562, 0x5a49deb1, 0x1b6725ba, 0x0e9845ea, 0xc0e15dfe, 0x7502c32f, 0xf012814c, 0x97a38d46, 0xf9c66bd3, 0x5fe7038f, 0x9c951592, 0x7aebbf6d, 0x59da9552, 0x832dd4be, 0x21d35874, 0x692949e0, 0xc8448ec9, 0x896a75c2, 0x7978f48e, 0x3e6b9958, 0x71dd27b9, 0x4fb6bee1, 0xad17f088, 0xac66c920, 0x3ab47dce, 0x4a1863df, 0x3182e51a, 0x33609751, 0x7f456253, 0x77e0b164, 0xae84bb6b, 0xa01cfe81, 0x2b94f908, 0x68587048, 0xfd198f45, 0x6c8794de, 0xf8b7527b, 0xd323ab73, 0x02e2724b, 0x8f57e31f, 0xab2a6655, 0x2807b2eb, 0xc2032fb5, 0x7b9a86c5, 0x08a5d337, 0x87f23028, 0xa5b223bf, 0x6aba0203, 0x825ced16, 0x1c2b8acf, 0xb492a779, 0xf2f0f307, 0xe2a14e69, 0xf4cd65da, 0xbed50605, 0x621fd134, 0xfe8ac4a6, 0x539d342e, 0x55a0a2f3, 0xe132058a, 0xeb75a4f6, 0xec390b83, 0xefaa4060, 0x9f065e71, 0x1051bd6e, 0x8af93e21, 0x063d96dd, 0x05aedd3e, 0xbd464de6, 0x8db59154, 0x5d0571c4, 0xd46f0406, 0x15ff6050, 0xfb241998, 0xe997d6bd, 0x43cc8940, 0x9e7767d9, 0x42bdb0e8, 0x8b880789, 0x5b38e719, 0xeedb79c8, 0x0a47a17c, 0x0fe97c42, 0x1ec9f884, 0x00000000, 0x86830980, 0xed48322b, 0x70ac1e11, 0x724e6c5a, 0xfffbfd0e, 0x38560f85, 0xd51e3dae, 0x3927362d, 0xd9640a0f, 0xa621685c, 0x54d19b5b, 0x2e3a2436, 0x67b10c0a, 0xe70f9357, 0x96d2b4ee, 0x919e1b9b, 0xc54f80c0, 0x20a261dc, 0x4b695a77, 0x1a161c12, 0xba0ae293, 0x2ae5c0a0, 0xe0433c22, 0x171d121b, 0x0d0b0e09, 0xc7adf28b, 0xa8b92db6, 0xa9c8141e, 0x198557f1, 0x074caf75, 0xddbbee99, 0x60fda37f, 0x269ff701, 0xf5bc5c72, 0x3bc54466, 0x7e345bfb, 0x29768b43, 0xc6dccb23, 0xfc68b6ed, 0xf163b8e4, 0xdccad731, 0x85104263, 0x22401397, 0x112084c6, 0x247d854a, 0x3df8d2bb, 0x3211aef9, 0xa16dc729, 0x2f4b1d9e, 0x30f3dcb2, 0x52ec0d86, 0xe3d077c1, 0x166c2bb3, 0xb999a970, 0x48fa1194, 0x642247e9, 0x8cc4a8fc, 0x3f1aa0f0, 0x2cd8567d, 0x90ef2233, 0x4ec78749, 0xd1c1d938, 0xa2fe8cca, 0x0b3698d4, 0x81cfa6f5, 0xde28a57a, 0x8e26dab7, 0xbfa43fad, 0x9de42c3a, 0x920d5078, 0xcc9b6a5f, 0x4662547e, 0x13c2f68d, 0xb8e890d8, 0xf75e2e39, 0xaff582c3, 0x80be9f5d, 0x937c69d0, 0x2da96fd5, 0x12b3cf25, 0x993bc8ac, 0x7da71018, 0x636ee89c, 0xbb7bdb3b, 0x7809cd26, 0x18f46e59, 0xb701ec9a, 0x9aa8834f, 0x6e65e695, 0xe67eaaff, 0xcf0821bc, 0xe8e6ef15, 0x9bd9bae7, 0x36ce4a6f, 0x09d4ea9f, 0x7cd629b0, 0xb2af31a4, 0x23312a3f, 0x9430c6a5, 0x66c035a2, 0xbc37744e, 0xcaa6fc82, 0xd0b0e090, 0xd81533a7, 0x984af104, 0xdaf741ec, 0x500e7fcd, 0xf62f1791, 0xd68d764d, 0xb04d43ef, 0x4d54ccaa, 0x04dfe496, 0xb5e39ed1, 0x881b4c6a, 0x1fb8c12c, 0x517f4665, 0xea049d5e, 0x355d018c, 0x7473fa87, 0x412efb0b, 0x1d5ab367, 0xd25292db, 0x5633e910, 0x47136dd6, 0x618c9ad7, 0x0c7a37a1, 0x148e59f8, 0x3c89eb13, 0x27eecea9, 0xc935b761, 0xe5ede11c, 0xb13c7a47, 0xdf599cd2, 0x733f55f2, 0xce791814, 0x37bf73c7, 0xcdea53f7, 0xaa5b5ffd, 0x6f14df3d, 0xdb867844, 0xf381caaf, 0xc43eb968, 0x342c3824, 0x405fc2a3, 0xc372161d, 0x250cbce2, 0x498b283c, 0x9541ff0d, 0x017139a8, 0xb3de080c, 0xe49cd8b4, 0xc1906456, 0x84617bcb, 0xb670d532, 0x5c74486c, 0x5742d0b8 ]
    T8 = [ 0xf4a75051, 0x4165537e, 0x17a4c31a, 0x275e963a, 0xab6bcb3b, 0x9d45f11f, 0xfa58abac, 0xe303934b, 0x30fa5520, 0x766df6ad, 0xcc769188, 0x024c25f5, 0xe5d7fc4f, 0x2acbd7c5, 0x35448026, 0x62a38fb5, 0xb15a49de, 0xba1b6725, 0xea0e9845, 0xfec0e15d, 0x2f7502c3, 0x4cf01281, 0x4697a38d, 0xd3f9c66b, 0x8f5fe703, 0x929c9515, 0x6d7aebbf, 0x5259da95, 0xbe832dd4, 0x7421d358, 0xe0692949, 0xc9c8448e, 0xc2896a75, 0x8e7978f4, 0x583e6b99, 0xb971dd27, 0xe14fb6be, 0x88ad17f0, 0x20ac66c9, 0xce3ab47d, 0xdf4a1863, 0x1a3182e5, 0x51336097, 0x537f4562, 0x6477e0b1, 0x6bae84bb, 0x81a01cfe, 0x082b94f9, 0x48685870, 0x45fd198f, 0xde6c8794, 0x7bf8b752, 0x73d323ab, 0x4b02e272, 0x1f8f57e3, 0x55ab2a66, 0xeb2807b2, 0xb5c2032f, 0xc57b9a86, 0x3708a5d3, 0x2887f230, 0xbfa5b223, 0x036aba02, 0x16825ced, 0xcf1c2b8a, 0x79b492a7, 0x07f2f0f3, 0x69e2a14e, 0xdaf4cd65, 0x05bed506, 0x34621fd1, 0xa6fe8ac4, 0x2e539d34, 0xf355a0a2, 0x8ae13205, 0xf6eb75a4, 0x83ec390b, 0x60efaa40, 0x719f065e, 0x6e1051bd, 0x218af93e, 0xdd063d96, 0x3e05aedd, 0xe6bd464d, 0x548db591, 0xc45d0571, 0x06d46f04, 0x5015ff60, 0x98fb2419, 0xbde997d6, 0x4043cc89, 0xd99e7767, 0xe842bdb0, 0x898b8807, 0x195b38e7, 0xc8eedb79, 0x7c0a47a1, 0x420fe97c, 0x841ec9f8, 0x00000000, 0x80868309, 0x2bed4832, 0x1170ac1e, 0x5a724e6c, 0x0efffbfd, 0x8538560f, 0xaed51e3d, 0x2d392736, 0x0fd9640a, 0x5ca62168, 0x5b54d19b, 0x362e3a24, 0x0a67b10c, 0x57e70f93, 0xee96d2b4, 0x9b919e1b, 0xc0c54f80, 0xdc20a261, 0x774b695a, 0x121a161c, 0x93ba0ae2, 0xa02ae5c0, 0x22e0433c, 0x1b171d12, 0x090d0b0e, 0x8bc7adf2, 0xb6a8b92d, 0x1ea9c814, 0xf1198557, 0x75074caf, 0x99ddbbee, 0x7f60fda3, 0x01269ff7, 0x72f5bc5c, 0x663bc544, 0xfb7e345b, 0x4329768b, 0x23c6dccb, 0xedfc68b6, 0xe4f163b8, 0x31dccad7, 0x63851042, 0x97224013, 0xc6112084, 0x4a247d85, 0xbb3df8d2, 0xf93211ae, 0x29a16dc7, 0x9e2f4b1d, 0xb230f3dc, 0x8652ec0d, 0xc1e3d077, 0xb3166c2b, 0x70b999a9, 0x9448fa11, 0xe9642247, 0xfc8cc4a8, 0xf03f1aa0, 0x7d2cd856, 0x3390ef22, 0x494ec787, 0x38d1c1d9, 0xcaa2fe8c, 0xd40b3698, 0xf581cfa6, 0x7ade28a5, 0xb78e26da, 0xadbfa43f, 0x3a9de42c, 0x78920d50, 0x5fcc9b6a, 0x7e466254, 0x8d13c2f6, 0xd8b8e890, 0x39f75e2e, 0xc3aff582, 0x5d80be9f, 0xd0937c69, 0xd52da96f, 0x2512b3cf, 0xac993bc8, 0x187da710, 0x9c636ee8, 0x3bbb7bdb, 0x267809cd, 0x5918f46e, 0x9ab701ec, 0x4f9aa883, 0x956e65e6, 0xffe67eaa, 0xbccf0821, 0x15e8e6ef, 0xe79bd9ba, 0x6f36ce4a, 0x9f09d4ea, 0xb07cd629, 0xa4b2af31, 0x3f23312a, 0xa59430c6, 0xa266c035, 0x4ebc3774, 0x82caa6fc, 0x90d0b0e0, 0xa7d81533, 0x04984af1, 0xecdaf741, 0xcd500e7f, 0x91f62f17, 0x4dd68d76, 0xefb04d43, 0xaa4d54cc, 0x9604dfe4, 0xd1b5e39e, 0x6a881b4c, 0x2c1fb8c1, 0x65517f46, 0x5eea049d, 0x8c355d01, 0x877473fa, 0x0b412efb, 0x671d5ab3, 0xdbd25292, 0x105633e9, 0xd647136d, 0xd7618c9a, 0xa10c7a37, 0xf8148e59, 0x133c89eb, 0xa927eece, 0x61c935b7, 0x1ce5ede1, 0x47b13c7a, 0xd2df599c, 0xf2733f55, 0x14ce7918, 0xc737bf73, 0xf7cdea53, 0xfdaa5b5f, 0x3d6f14df, 0x44db8678, 0xaff381ca, 0x68c43eb9, 0x24342c38, 0xa3405fc2, 0x1dc37216, 0xe2250cbc, 0x3c498b28, 0x0d9541ff, 0xa8017139, 0x0cb3de08, 0xb4e49cd8, 0x56c19064, 0xcb84617b, 0x32b670d5, 0x6c5c7448, 0xb85742d0 ]

    # Transformations for decryption key expansion
    U1 = [ 0x00000000, 0x0e090d0b, 0x1c121a16, 0x121b171d, 0x3824342c, 0x362d3927, 0x24362e3a, 0x2a3f2331, 0x70486858, 0x7e416553, 0x6c5a724e, 0x62537f45, 0x486c5c74, 0x4665517f, 0x547e4662, 0x5a774b69, 0xe090d0b0, 0xee99ddbb, 0xfc82caa6, 0xf28bc7ad, 0xd8b4e49c, 0xd6bde997, 0xc4a6fe8a, 0xcaaff381, 0x90d8b8e8, 0x9ed1b5e3, 0x8ccaa2fe, 0x82c3aff5, 0xa8fc8cc4, 0xa6f581cf, 0xb4ee96d2, 0xbae79bd9, 0xdb3bbb7b, 0xd532b670, 0xc729a16d, 0xc920ac66, 0xe31f8f57, 0xed16825c, 0xff0d9541, 0xf104984a, 0xab73d323, 0xa57ade28, 0xb761c935, 0xb968c43e, 0x9357e70f, 0x9d5eea04, 0x8f45fd19, 0x814cf012, 0x3bab6bcb, 0x35a266c0, 0x27b971dd, 0x29b07cd6, 0x038f5fe7, 0x0d8652ec, 0x1f9d45f1, 0x119448fa, 0x4be30393, 0x45ea0e98, 0x57f11985, 0x59f8148e, 0x73c737bf, 0x7dce3ab4, 0x6fd52da9, 0x61dc20a2, 0xad766df6, 0xa37f60fd, 0xb16477e0, 0xbf6d7aeb, 0x955259da, 0x9b5b54d1, 0x894043cc, 0x87494ec7, 0xdd3e05ae, 0xd33708a5, 0xc12c1fb8, 0xcf2512b3, 0xe51a3182, 0xeb133c89, 0xf9082b94, 0xf701269f, 0x4de6bd46, 0x43efb04d, 0x51f4a750, 0x5ffdaa5b, 0x75c2896a, 0x7bcb8461, 0x69d0937c, 0x67d99e77, 0x3daed51e, 0x33a7d815, 0x21bccf08, 0x2fb5c203, 0x058ae132, 0x0b83ec39, 0x1998fb24, 0x1791f62f, 0x764dd68d, 0x7844db86, 0x6a5fcc9b, 0x6456c190, 0x4e69e2a1, 0x4060efaa, 0x527bf8b7, 0x5c72f5bc, 0x0605bed5, 0x080cb3de, 0x1a17a4c3, 0x141ea9c8, 0x3e218af9, 0x302887f2, 0x223390ef, 0x2c3a9de4, 0x96dd063d, 0x98d40b36, 0x8acf1c2b, 0x84c61120, 0xaef93211, 0xa0f03f1a, 0xb2eb2807, 0xbce2250c, 0xe6956e65, 0xe89c636e, 0xfa877473, 0xf48e7978, 0xdeb15a49, 0xd0b85742, 0xc2a3405f, 0xccaa4d54, 0x41ecdaf7, 0x4fe5d7fc, 0x5dfec0e1, 0x53f7cdea, 0x79c8eedb, 0x77c1e3d0, 0x65daf4cd, 0x6bd3f9c6, 0x31a4b2af, 0x3fadbfa4, 0x2db6a8b9, 0x23bfa5b2, 0x09808683, 0x07898b88, 0x15929c95, 0x1b9b919e, 0xa17c0a47, 0xaf75074c, 0xbd6e1051, 0xb3671d5a, 0x99583e6b, 0x97513360, 0x854a247d, 0x8b432976, 0xd134621f, 0xdf3d6f14, 0xcd267809, 0xc32f7502, 0xe9105633, 0xe7195b38, 0xf5024c25, 0xfb0b412e, 0x9ad7618c, 0x94de6c87, 0x86c57b9a, 0x88cc7691, 0xa2f355a0, 0xacfa58ab, 0xbee14fb6, 0xb0e842bd, 0xea9f09d4, 0xe49604df, 0xf68d13c2, 0xf8841ec9, 0xd2bb3df8, 0xdcb230f3, 0xcea927ee, 0xc0a02ae5, 0x7a47b13c, 0x744ebc37, 0x6655ab2a, 0x685ca621, 0x42638510, 0x4c6a881b, 0x5e719f06, 0x5078920d, 0x0a0fd964, 0x0406d46f, 0x161dc372, 0x1814ce79, 0x322bed48, 0x3c22e043, 0x2e39f75e, 0x2030fa55, 0xec9ab701, 0xe293ba0a, 0xf088ad17, 0xfe81a01c, 0xd4be832d, 0xdab78e26, 0xc8ac993b, 0xc6a59430, 0x9cd2df59, 0x92dbd252, 0x80c0c54f, 0x8ec9c844, 0xa4f6eb75, 0xaaffe67e, 0xb8e4f163, 0xb6edfc68, 0x0c0a67b1, 0x02036aba, 0x10187da7, 0x1e1170ac, 0x342e539d, 0x3a275e96, 0x283c498b, 0x26354480, 0x7c420fe9, 0x724b02e2, 0x605015ff, 0x6e5918f4, 0x44663bc5, 0x4a6f36ce, 0x587421d3, 0x567d2cd8, 0x37a10c7a, 0x39a80171, 0x2bb3166c, 0x25ba1b67, 0x0f853856, 0x018c355d, 0x13972240, 0x1d9e2f4b, 0x47e96422, 0x49e06929, 0x5bfb7e34, 0x55f2733f, 0x7fcd500e, 0x71c45d05, 0x63df4a18, 0x6dd64713, 0xd731dcca, 0xd938d1c1, 0xcb23c6dc, 0xc52acbd7, 0xef15e8e6, 0xe11ce5ed, 0xf307f2f0, 0xfd0efffb, 0xa779b492, 0xa970b999, 0xbb6bae84, 0xb562a38f, 0x9f5d80be, 0x91548db5, 0x834f9aa8, 0x8d4697a3 ]
    U2 = [ 0x00000000, 0x0b0e090d, 0x161c121a, 0x1d121b17, 0x2c382434, 0x27362d39, 0x3a24362e, 0x312a3f23, 0x58704868, 0x537e4165, 0x4e6c5a72, 0x4562537f, 0x74486c5c, 0x7f466551, 0x62547e46, 0x695a774b, 0xb0e090d0, 0xbbee99dd, 0xa6fc82ca, 0xadf28bc7, 0x9cd8b4e4, 0x97d6bde9, 0x8ac4a6fe, 0x81caaff3, 0xe890d8b8, 0xe39ed1b5, 0xfe8ccaa2, 0xf582c3af, 0xc4a8fc8c, 0xcfa6f581, 0xd2b4ee96, 0xd9bae79b, 0x7bdb3bbb, 0x70d532b6, 0x6dc729a1, 0x66c920ac, 0x57e31f8f, 0x5ced1682, 0x41ff0d95, 0x4af10498, 0x23ab73d3, 0x28a57ade, 0x35b761c9, 0x3eb968c4, 0x0f9357e7, 0x049d5eea, 0x198f45fd, 0x12814cf0, 0xcb3bab6b, 0xc035a266, 0xdd27b971, 0xd629b07c, 0xe7038f5f, 0xec0d8652, 0xf11f9d45, 0xfa119448, 0x934be303, 0x9845ea0e, 0x8557f119, 0x8e59f814, 0xbf73c737, 0xb47dce3a, 0xa96fd52d, 0xa261dc20, 0xf6ad766d, 0xfda37f60, 0xe0b16477, 0xebbf6d7a, 0xda955259, 0xd19b5b54, 0xcc894043, 0xc787494e, 0xaedd3e05, 0xa5d33708, 0xb8c12c1f, 0xb3cf2512, 0x82e51a31, 0x89eb133c, 0x94f9082b, 0x9ff70126, 0x464de6bd, 0x4d43efb0, 0x5051f4a7, 0x5b5ffdaa, 0x6a75c289, 0x617bcb84, 0x7c69d093, 0x7767d99e, 0x1e3daed5, 0x1533a7d8, 0x0821bccf, 0x032fb5c2, 0x32058ae1, 0x390b83ec, 0x241998fb, 0x2f1791f6, 0x8d764dd6, 0x867844db, 0x9b6a5fcc, 0x906456c1, 0xa14e69e2, 0xaa4060ef, 0xb7527bf8, 0xbc5c72f5, 0xd50605be, 0xde080cb3, 0xc31a17a4, 0xc8141ea9, 0xf93e218a, 0xf2302887, 0xef223390, 0xe42c3a9d, 0x3d96dd06, 0x3698d40b, 0x2b8acf1c, 0x2084c611, 0x11aef932, 0x1aa0f03f, 0x07b2eb28, 0x0cbce225, 0x65e6956e, 0x6ee89c63, 0x73fa8774, 0x78f48e79, 0x49deb15a, 0x42d0b857, 0x5fc2a340, 0x54ccaa4d, 0xf741ecda, 0xfc4fe5d7, 0xe15dfec0, 0xea53f7cd, 0xdb79c8ee, 0xd077c1e3, 0xcd65daf4, 0xc66bd3f9, 0xaf31a4b2, 0xa43fadbf, 0xb92db6a8, 0xb223bfa5, 0x83098086, 0x8807898b, 0x9515929c, 0x9e1b9b91, 0x47a17c0a, 0x4caf7507, 0x51bd6e10, 0x5ab3671d, 0x6b99583e, 0x60975133, 0x7d854a24, 0x768b4329, 0x1fd13462, 0x14df3d6f, 0x09cd2678, 0x02c32f75, 0x33e91056, 0x38e7195b, 0x25f5024c, 0x2efb0b41, 0x8c9ad761, 0x8794de6c, 0x9a86c57b, 0x9188cc76, 0xa0a2f355, 0xabacfa58, 0xb6bee14f, 0xbdb0e842, 0xd4ea9f09, 0xdfe49604, 0xc2f68d13, 0xc9f8841e, 0xf8d2bb3d, 0xf3dcb230, 0xeecea927, 0xe5c0a02a, 0x3c7a47b1, 0x37744ebc, 0x2a6655ab, 0x21685ca6, 0x10426385, 0x1b4c6a88, 0x065e719f, 0x0d507892, 0x640a0fd9, 0x6f0406d4, 0x72161dc3, 0x791814ce, 0x48322bed, 0x433c22e0, 0x5e2e39f7, 0x552030fa, 0x01ec9ab7, 0x0ae293ba, 0x17f088ad, 0x1cfe81a0, 0x2dd4be83, 0x26dab78e, 0x3bc8ac99, 0x30c6a594, 0x599cd2df, 0x5292dbd2, 0x4f80c0c5, 0x448ec9c8, 0x75a4f6eb, 0x7eaaffe6, 0x63b8e4f1, 0x68b6edfc, 0xb10c0a67, 0xba02036a, 0xa710187d, 0xac1e1170, 0x9d342e53, 0x963a275e, 0x8b283c49, 0x80263544, 0xe97c420f, 0xe2724b02, 0xff605015, 0xf46e5918, 0xc544663b, 0xce4a6f36, 0xd3587421, 0xd8567d2c, 0x7a37a10c, 0x7139a801, 0x6c2bb316, 0x6725ba1b, 0x560f8538, 0x5d018c35, 0x40139722, 0x4b1d9e2f, 0x2247e964, 0x2949e069, 0x345bfb7e, 0x3f55f273, 0x0e7fcd50, 0x0571c45d, 0x1863df4a, 0x136dd647, 0xcad731dc, 0xc1d938d1, 0xdccb23c6, 0xd7c52acb, 0xe6ef15e8, 0xede11ce5, 0xf0f307f2, 0xfbfd0eff, 0x92a779b4, 0x99a970b9, 0x84bb6bae, 0x8fb562a3, 0xbe9f5d80, 0xb591548d, 0xa8834f9a, 0xa38d4697 ]
    U3 = [ 0x00000000, 0x0d0b0e09, 0x1a161c12, 0x171d121b, 0x342c3824, 0x3927362d, 0x2e3a2436, 0x23312a3f, 0x68587048, 0x65537e41, 0x724e6c5a, 0x7f456253, 0x5c74486c, 0x517f4665, 0x4662547e, 0x4b695a77, 0xd0b0e090, 0xddbbee99, 0xcaa6fc82, 0xc7adf28b, 0xe49cd8b4, 0xe997d6bd, 0xfe8ac4a6, 0xf381caaf, 0xb8e890d8, 0xb5e39ed1, 0xa2fe8cca, 0xaff582c3, 0x8cc4a8fc, 0x81cfa6f5, 0x96d2b4ee, 0x9bd9bae7, 0xbb7bdb3b, 0xb670d532, 0xa16dc729, 0xac66c920, 0x8f57e31f, 0x825ced16, 0x9541ff0d, 0x984af104, 0xd323ab73, 0xde28a57a, 0xc935b761, 0xc43eb968, 0xe70f9357, 0xea049d5e, 0xfd198f45, 0xf012814c, 0x6bcb3bab, 0x66c035a2, 0x71dd27b9, 0x7cd629b0, 0x5fe7038f, 0x52ec0d86, 0x45f11f9d, 0x48fa1194, 0x03934be3, 0x0e9845ea, 0x198557f1, 0x148e59f8, 0x37bf73c7, 0x3ab47dce, 0x2da96fd5, 0x20a261dc, 0x6df6ad76, 0x60fda37f, 0x77e0b164, 0x7aebbf6d, 0x59da9552, 0x54d19b5b, 0x43cc8940, 0x4ec78749, 0x05aedd3e, 0x08a5d337, 0x1fb8c12c, 0x12b3cf25, 0x3182e51a, 0x3c89eb13, 0x2b94f908, 0x269ff701, 0xbd464de6, 0xb04d43ef, 0xa75051f4, 0xaa5b5ffd, 0x896a75c2, 0x84617bcb, 0x937c69d0, 0x9e7767d9, 0xd51e3dae, 0xd81533a7, 0xcf0821bc, 0xc2032fb5, 0xe132058a, 0xec390b83, 0xfb241998, 0xf62f1791, 0xd68d764d, 0xdb867844, 0xcc9b6a5f, 0xc1906456, 0xe2a14e69, 0xefaa4060, 0xf8b7527b, 0xf5bc5c72, 0xbed50605, 0xb3de080c, 0xa4c31a17, 0xa9c8141e, 0x8af93e21, 0x87f23028, 0x90ef2233, 0x9de42c3a, 0x063d96dd, 0x0b3698d4, 0x1c2b8acf, 0x112084c6, 0x3211aef9, 0x3f1aa0f0, 0x2807b2eb, 0x250cbce2, 0x6e65e695, 0x636ee89c, 0x7473fa87, 0x7978f48e, 0x5a49deb1, 0x5742d0b8, 0x405fc2a3, 0x4d54ccaa, 0xdaf741ec, 0xd7fc4fe5, 0xc0e15dfe, 0xcdea53f7, 0xeedb79c8, 0xe3d077c1, 0xf4cd65da, 0xf9c66bd3, 0xb2af31a4, 0xbfa43fad, 0xa8b92db6, 0xa5b223bf, 0x86830980, 0x8b880789, 0x9c951592, 0x919e1b9b, 0x0a47a17c, 0x074caf75, 0x1051bd6e, 0x1d5ab367, 0x3e6b9958, 0x33609751, 0x247d854a, 0x29768b43, 0x621fd134, 0x6f14df3d, 0x7809cd26, 0x7502c32f, 0x5633e910, 0x5b38e719, 0x4c25f502, 0x412efb0b, 0x618c9ad7, 0x6c8794de, 0x7b9a86c5, 0x769188cc, 0x55a0a2f3, 0x58abacfa, 0x4fb6bee1, 0x42bdb0e8, 0x09d4ea9f, 0x04dfe496, 0x13c2f68d, 0x1ec9f884, 0x3df8d2bb, 0x30f3dcb2, 0x27eecea9, 0x2ae5c0a0, 0xb13c7a47, 0xbc37744e, 0xab2a6655, 0xa621685c, 0x85104263, 0x881b4c6a, 0x9f065e71, 0x920d5078, 0xd9640a0f, 0xd46f0406, 0xc372161d, 0xce791814, 0xed48322b, 0xe0433c22, 0xf75e2e39, 0xfa552030, 0xb701ec9a, 0xba0ae293, 0xad17f088, 0xa01cfe81, 0x832dd4be, 0x8e26dab7, 0x993bc8ac, 0x9430c6a5, 0xdf599cd2, 0xd25292db, 0xc54f80c0, 0xc8448ec9, 0xeb75a4f6, 0xe67eaaff, 0xf163b8e4, 0xfc68b6ed, 0x67b10c0a, 0x6aba0203, 0x7da71018, 0x70ac1e11, 0x539d342e, 0x5e963a27, 0x498b283c, 0x44802635, 0x0fe97c42, 0x02e2724b, 0x15ff6050, 0x18f46e59, 0x3bc54466, 0x36ce4a6f, 0x21d35874, 0x2cd8567d, 0x0c7a37a1, 0x017139a8, 0x166c2bb3, 0x1b6725ba, 0x38560f85, 0x355d018c, 0x22401397, 0x2f4b1d9e, 0x642247e9, 0x692949e0, 0x7e345bfb, 0x733f55f2, 0x500e7fcd, 0x5d0571c4, 0x4a1863df, 0x47136dd6, 0xdccad731, 0xd1c1d938, 0xc6dccb23, 0xcbd7c52a, 0xe8e6ef15, 0xe5ede11c, 0xf2f0f307, 0xfffbfd0e, 0xb492a779, 0xb999a970, 0xae84bb6b, 0xa38fb562, 0x80be9f5d, 0x8db59154, 0x9aa8834f, 0x97a38d46 ]
    U4 = [ 0x00000000, 0x090d0b0e, 0x121a161c, 0x1b171d12, 0x24342c38, 0x2d392736, 0x362e3a24, 0x3f23312a, 0x48685870, 0x4165537e, 0x5a724e6c, 0x537f4562, 0x6c5c7448, 0x65517f46, 0x7e466254, 0x774b695a, 0x90d0b0e0, 0x99ddbbee, 0x82caa6fc, 0x8bc7adf2, 0xb4e49cd8, 0xbde997d6, 0xa6fe8ac4, 0xaff381ca, 0xd8b8e890, 0xd1b5e39e, 0xcaa2fe8c, 0xc3aff582, 0xfc8cc4a8, 0xf581cfa6, 0xee96d2b4, 0xe79bd9ba, 0x3bbb7bdb, 0x32b670d5, 0x29a16dc7, 0x20ac66c9, 0x1f8f57e3, 0x16825ced, 0x0d9541ff, 0x04984af1, 0x73d323ab, 0x7ade28a5, 0x61c935b7, 0x68c43eb9, 0x57e70f93, 0x5eea049d, 0x45fd198f, 0x4cf01281, 0xab6bcb3b, 0xa266c035, 0xb971dd27, 0xb07cd629, 0x8f5fe703, 0x8652ec0d, 0x9d45f11f, 0x9448fa11, 0xe303934b, 0xea0e9845, 0xf1198557, 0xf8148e59, 0xc737bf73, 0xce3ab47d, 0xd52da96f, 0xdc20a261, 0x766df6ad, 0x7f60fda3, 0x6477e0b1, 0x6d7aebbf, 0x5259da95, 0x5b54d19b, 0x4043cc89, 0x494ec787, 0x3e05aedd, 0x3708a5d3, 0x2c1fb8c1, 0x2512b3cf, 0x1a3182e5, 0x133c89eb, 0x082b94f9, 0x01269ff7, 0xe6bd464d, 0xefb04d43, 0xf4a75051, 0xfdaa5b5f, 0xc2896a75, 0xcb84617b, 0xd0937c69, 0xd99e7767, 0xaed51e3d, 0xa7d81533, 0xbccf0821, 0xb5c2032f, 0x8ae13205, 0x83ec390b, 0x98fb2419, 0x91f62f17, 0x4dd68d76, 0x44db8678, 0x5fcc9b6a, 0x56c19064, 0x69e2a14e, 0x60efaa40, 0x7bf8b752, 0x72f5bc5c, 0x05bed506, 0x0cb3de08, 0x17a4c31a, 0x1ea9c814, 0x218af93e, 0x2887f230, 0x3390ef22, 0x3a9de42c, 0xdd063d96, 0xd40b3698, 0xcf1c2b8a, 0xc6112084, 0xf93211ae, 0xf03f1aa0, 0xeb2807b2, 0xe2250cbc, 0x956e65e6, 0x9c636ee8, 0x877473fa, 0x8e7978f4, 0xb15a49de, 0xb85742d0, 0xa3405fc2, 0xaa4d54cc, 0xecdaf741, 0xe5d7fc4f, 0xfec0e15d, 0xf7cdea53, 0xc8eedb79, 0xc1e3d077, 0xdaf4cd65, 0xd3f9c66b, 0xa4b2af31, 0xadbfa43f, 0xb6a8b92d, 0xbfa5b223, 0x80868309, 0x898b8807, 0x929c9515, 0x9b919e1b, 0x7c0a47a1, 0x75074caf, 0x6e1051bd, 0x671d5ab3, 0x583e6b99, 0x51336097, 0x4a247d85, 0x4329768b, 0x34621fd1, 0x3d6f14df, 0x267809cd, 0x2f7502c3, 0x105633e9, 0x195b38e7, 0x024c25f5, 0x0b412efb, 0xd7618c9a, 0xde6c8794, 0xc57b9a86, 0xcc769188, 0xf355a0a2, 0xfa58abac, 0xe14fb6be, 0xe842bdb0, 0x9f09d4ea, 0x9604dfe4, 0x8d13c2f6, 0x841ec9f8, 0xbb3df8d2, 0xb230f3dc, 0xa927eece, 0xa02ae5c0, 0x47b13c7a, 0x4ebc3774, 0x55ab2a66, 0x5ca62168, 0x63851042, 0x6a881b4c, 0x719f065e, 0x78920d50, 0x0fd9640a, 0x06d46f04, 0x1dc37216, 0x14ce7918, 0x2bed4832, 0x22e0433c, 0x39f75e2e, 0x30fa5520, 0x9ab701ec, 0x93ba0ae2, 0x88ad17f0, 0x81a01cfe, 0xbe832dd4, 0xb78e26da, 0xac993bc8, 0xa59430c6, 0xd2df599c, 0xdbd25292, 0xc0c54f80, 0xc9c8448e, 0xf6eb75a4, 0xffe67eaa, 0xe4f163b8, 0xedfc68b6, 0x0a67b10c, 0x036aba02, 0x187da710, 0x1170ac1e, 0x2e539d34, 0x275e963a, 0x3c498b28, 0x35448026, 0x420fe97c, 0x4b02e272, 0x5015ff60, 0x5918f46e, 0x663bc544, 0x6f36ce4a, 0x7421d358, 0x7d2cd856, 0xa10c7a37, 0xa8017139, 0xb3166c2b, 0xba1b6725, 0x8538560f, 0x8c355d01, 0x97224013, 0x9e2f4b1d, 0xe9642247, 0xe0692949, 0xfb7e345b, 0xf2733f55, 0xcd500e7f, 0xc45d0571, 0xdf4a1863, 0xd647136d, 0x31dccad7, 0x38d1c1d9, 0x23c6dccb, 0x2acbd7c5, 0x15e8e6ef, 0x1ce5ede1, 0x07f2f0f3, 0x0efffbfd, 0x79b492a7, 0x70b999a9, 0x6bae84bb, 0x62a38fb5, 0x5d80be9f, 0x548db591, 0x4f9aa883, 0x4697a38d ]

    def __init__(self, key):

        if len(key) not in (16, 24, 32):
            raise ValueError('Invalid key size')

        rounds = self.number_of_rounds[len(key)]

        # Encryption round keys
        self._Ke = [[0] * 4 for i in range(rounds + 1)]

        # Decryption round keys
        self._Kd = [[0] * 4 for i in range(rounds + 1)]

        round_key_count = (rounds + 1) * 4
        KC = len(key) // 4

        # Convert the key into ints
        tk = [ struct.unpack('>i', key[i:i + 4])[0] for i in range(0, len(key), 4) ]

        # Copy values into round key arrays
        for i in range(0, KC):
            self._Ke[i // 4][i % 4] = tk[i]
            self._Kd[rounds - (i // 4)][i % 4] = tk[i]

        # Key expansion (fips-197 section 5.2)
        rconpointer = 0
        t = KC
        while t < round_key_count:

            tt = tk[KC - 1]
            tk[0] ^= ((self.S[(tt >> 16) & 0xFF] << 24) ^
                      (self.S[(tt >>  8) & 0xFF] << 16) ^
                      (self.S[ tt        & 0xFF] <<  8) ^
                       self.S[(tt >> 24) & 0xFF]        ^
                      (self.rcon[rconpointer] << 24))
            rconpointer += 1

            if KC != 8:
                for i in range(1, KC):
                    tk[i] ^= tk[i - 1]

            # Key expansion for 256-bit keys is "slightly different" (fips-197)
            else:
                for i in range(1, KC // 2):
                    tk[i] ^= tk[i - 1]
                tt = tk[KC // 2 - 1]

                tk[KC // 2] ^= (self.S[ tt        & 0xFF]        ^
                               (self.S[(tt >>  8) & 0xFF] <<  8) ^
                               (self.S[(tt >> 16) & 0xFF] << 16) ^
                               (self.S[(tt >> 24) & 0xFF] << 24))

                for i in range(KC // 2 + 1, KC):
                    tk[i] ^= tk[i - 1]

            # Copy values into round key arrays
            j = 0
            while j < KC and t < round_key_count:
                self._Ke[t // 4][t % 4] = tk[j]
                self._Kd[rounds - (t // 4)][t % 4] = tk[j]
                j += 1
                t += 1

        # Inverse-Cipher-ify the decryption round key (fips-197 section 5.3)
        for r in range(1, rounds):
            for j in range(0, 4):
                tt = self._Kd[r][j]
                self._Kd[r][j] = (self.U1[(tt >> 24) & 0xFF] ^
                                  self.U2[(tt >> 16) & 0xFF] ^
                                  self.U3[(tt >>  8) & 0xFF] ^
                                  self.U4[ tt        & 0xFF])

    def encrypt(self, plaintext):
        'Encrypt a block of plain text using the AES block cipher.'

        if len(plaintext) != 16:
            raise ValueError('wrong block length')

        rounds = len(self._Ke) - 1
        (s1, s2, s3) = [1, 2, 3]
        a = [0, 0, 0, 0]

        # Convert plaintext to (ints ^ key)
        t = [(AES._compact_word(plaintext[4 * i:4 * i + 4]) ^ self._Ke[0][i]) for i in range(0, 4)]

        # Apply round transforms
        for r in range(1, rounds):
            for i in range(0, 4):
                a[i] = (self.T1[(t[ i          ] >> 24) & 0xFF] ^
                        self.T2[(t[(i + s1) % 4] >> 16) & 0xFF] ^
                        self.T3[(t[(i + s2) % 4] >>  8) & 0xFF] ^
                        self.T4[ t[(i + s3) % 4]        & 0xFF] ^
                        self._Ke[r][i])
            t = copy.copy(a)

        # The last round is special
        result = [ ]
        for i in range(0, 4):
            tt = self._Ke[rounds][i]
            result.append((self.S[(t[ i           ] >> 24) & 0xFF] ^ (tt >> 24)) & 0xFF)
            result.append((self.S[(t[(i + s1) % 4] >> 16) & 0xFF] ^ (tt >> 16)) & 0xFF)
            result.append((self.S[(t[(i + s2) % 4] >>  8) & 0xFF] ^ (tt >>  8)) & 0xFF)
            result.append((self.S[ t[(i + s3) % 4]        & 0xFF] ^  tt       ) & 0xFF)

        return result

    def decrypt(self, ciphertext):
        'Decrypt a block of cipher text using the AES block cipher.'

        if len(ciphertext) != 16:
            raise ValueError('wrong block length')

        rounds = len(self._Kd) - 1
        (s1, s2, s3) = [3, 2, 1]
        a = [0, 0, 0, 0]

        # Convert ciphertext to (ints ^ key)
        t = [(AES._compact_word(ciphertext[4 * i:4 * i + 4]) ^ self._Kd[0][i]) for i in range(0, 4)]

        # Apply round transforms
        for r in range(1, rounds):
            for i in range(0, 4):
                a[i] = (self.T5[(t[ i          ] >> 24) & 0xFF] ^
                        self.T6[(t[(i + s1) % 4] >> 16) & 0xFF] ^
                        self.T7[(t[(i + s2) % 4] >>  8) & 0xFF] ^
                        self.T8[ t[(i + s3) % 4]        & 0xFF] ^
                        self._Kd[r][i])
            t = copy.copy(a)

        # The last round is special
        result = [ ]
        for i in range(0, 4):
            tt = self._Kd[rounds][i]
            result.append((self.Si[(t[ i           ] >> 24) & 0xFF] ^ (tt >> 24)) & 0xFF)
            result.append((self.Si[(t[(i + s1) % 4] >> 16) & 0xFF] ^ (tt >> 16)) & 0xFF)
            result.append((self.Si[(t[(i + s2) % 4] >>  8) & 0xFF] ^ (tt >>  8)) & 0xFF)
            result.append((self.Si[ t[(i + s3) % 4]        & 0xFF] ^  tt       ) & 0xFF)

        return result

class AES_128_CBC:

    def __init__(self, key, iv = None):
        self._aes = AES(key)
        if iv is None:
            self._last_cipherblock = [ 0 ] * 16
        elif len(iv) != 16:
            raise ValueError('initialization vector must be 16 bytes')
        else:
            self._last_cipherblock = iv


    def encrypt(self, plaintext):
        if len(plaintext) != 16:
            raise ValueError('plaintext block must be 16 bytes')

        precipherblock = [ (p ^ l) for (p, l) in zip(plaintext, self._last_cipherblock) ]
        self._last_cipherblock = self._aes.encrypt(precipherblock)

        return b''.join(map(lambda x: x.to_bytes(1, 'little'), self._last_cipherblock))

    def decrypt(self, ciphertext):
        if len(ciphertext) != 16:
            raise ValueError('ciphertext block must be 16 bytes')

        cipherblock = ciphertext
        plaintext = [ (p ^ l) for (p, l) in zip(self._aes.decrypt(cipherblock), self._last_cipherblock) ]
        self._last_cipherblock = cipherblock

        return b''.join(map(lambda x: x.to_bytes(1, 'little'), plaintext))

ISP_PROG = '789cecbd7b5c5357f638bacf494e0e41503440b0c416898032d64151b16a191042145bc76a816aab050f88587c023eda321292438c68d1064c3038455a41996f1d2b6aac2fa48ab476dab10fa5edf48106082a2a541e6241eedae79cf0aa33dfdfbddffbb97fdccfd77e16ebacfd587bedb5d7da7bed7df649c71eba7ffec39f0944a0c1ffd2160605a52df40108c330d5442264ccce1e91b67b5190268c08d7841373347388084d0411a98924541a1511a58922d41a353157339798a79947446ba289f99af9c40b9a178817352f120b340b883f6bfe5cb822ad980c4a730b428b116af906603101186031091860b10830c062316080c5146080c512c0008b69c0008b9d00032c96020658ec0c1860f130c0008b5d00032c76050cb078386080c523000398f6409f34554be42508c9c8637f936d24bbd3fcc25a6584070a2546ed59e7b37b7ec248cfba07be3e53991f493287bc358a319364c2c8a7ea4cef627d909fa629c35a878bf6bd4b326309ed311231db4994bd622cb10ef978a7219f20fc4c6c90d43b370d6f1ed5e2d9f6d4c3a7bb4bea4aebcb9b8e341f6b39d976fae1f9ee3937a21aa26f2db8bba835b67d69d7f29e9b371a1b6edfba77f7d7d68ef6475d8f7b027c08b7807123dd02c68f750b9838d92dc0277c54c0b89746058c4f18153071c3a8001f8d7bc0b83dee01e30fb8074cfcc83dc0a7ca3360dc579e01e36f78064c6cf584faa3a1fe68a83f1aea8f86fade50df1bea7b437d6fa83f06ea8f81fa63a0fe18a8ff0cd47f06ea3f03f59f49f3f399fac0cf6daa738e3bc9c450e8becfee974717df0fdafd8734378fa925f173126e26901b4b36ce49bb9926492c4d8c4a6a4c926c2add14b5b971b3f3aaf255d129b7539cdf2c7f33faaddb6f0d4f3d92ba60cdbd35c3ff72e42f0bb6dddb4643dff43e1a377a2c31523f563392f62546e97d35a3682521d32b35327a1ce1ae1fa771a7fd080fbd9fc683f6273cf5fe1a4f3a8090eb0334727a3ce1a51faff1a22710a3f51334a3e940e2297da0e629fa0f84b7fe0f1a6f7a22a1d04fd428e8678931fa673563e849c4d3fa499aa7e93f12cfe8ffa8794646103e789c108251aa73ae1fd5e4d9fc54cbd36dbe0ffdbbcbeb8ed41f6b3ad97cbae57cdb270f2f7747df58d0b0e856ecdda5adcbdb5774adecb97de35ec3afb73aee3e6a7ddcfec03708eded7ae0eb36756f0f592229752e1f7e64d431cf934f9d7efa7c4949696979f99123c78e9d3c79faf4f9f373de8f2a8bfedb82bf2faa88b52e3db3bcf2e6fb8d65b7ff76efefbf5674581f9d795cc9dbd69c32876d61bb521ef545a68508d9b3ea4e0bf9071df9a28f4844267cb9316df714740ffe8e9a6af545c8924d6ec79e961def9b3067c5cd15645a49da9cf49be992a4d2a4a8958d2b259b4b37476d69dce29c529e12bdfaf66ae7b7cadf8a7efbf6dbc3d71c59b360edbdb5c3b71dd936cae798cfa2b1bf8e1d35e5d89445c1bf067b8e3b392ed6afc3cf73fac9e9b1211d214f8d3f3d7ee98447139e9a797ae6d2598f663d3df1fcc4e5cf3e7ef6e9d0f3a1cbfff4f84f0eed868f94d4a7f987b59af420b93ec052c4546d32ff39238f5d69ccf1fc3226cffc4fb35a962c47e69aef38fc5d4dbe3a84eeeacd9477bd935ff3ad3a23efbb9aefe673399f631c00d83c7fabc50c7f3165fe9c5533cf74204a650ac33a8a671f244706a5a1856e0f02c2a61ec8edf997c90da7fb7c54124fa8c289ec2c7901f83cc5169b4c5822ba98319421b90865c944117f674422446a1d65547f350136b2d5fb0dbb76b1067545753ba9f98c2fabfd2f4759cc475ba3b7b0f7715f81c0ad3d32d1280bfa5b6ef85c68af90cb01288967d572209464a719cb031cb8b2c965bb2e868fe45bf4fb2b5fcb6fafc091ab174e40db2819693be4668444735fc91fa39e25a709be27c9052648d57ebaaac0756e1133cbcb8b084ea60922c07cd15bdfd1fbdd454a6dae292f60c69c20e1e9f37f2cd6f879eb29c4b49d44de7a09d2a8bc59a09806d2e841939a3d857f9db4b7f5b1f2108d941fd088506567519448ddde7bea9bcc4ad1215a124c9d442ca5441471c3ca4bb3259797869d2bc8b3934f5fb513a4313bf549a3fc404e801c9e27c43b17cb68449ea1ac6193f443e448ed9783524fda6bfe5c462192bdbd27ca1ce7916b7bbaf689926558b154221505921dfa26a972e762cc7196d3893026fd3be44d3b61eedb81fbaa26c4739fb4b7f0af6bacc14e506bae13ee4f314d775512230bd5e311ac6951ac4ad2ac14b7227e54eb5a6f820d510930629c35abff52c478d30eddba871fffe66500f3e7df2ed6f8e39699f4ebd02af429ca9b056a6d03327a42abef8efeebc9820d837ac06994bd865809d6e867955b37f837f7c495eb3254be2d9236a57b2b92a7833d883f18c55bb9cf9586fa3182c5fbd43c2f3c5df854a3f2139eebbefc483556650ae2d213ab713af78c12f7a82608cf614c81ea59e1396b45a16ab2a37cc27ed53447f90445bc1c7aab9cd5b9b64a8d9fde9774a61ee09e9454e7da6bfc9353672aaf137a4d112305ed7df7b9b294261d7d040bc716e1c2959dd9b94a13c5a794cd21a20c2a2e35b87315afe5ac7f95ac27d36f26122a15687a82a36fa7e6393cfcb4064bca3d675d50a472b5677726e2f6dfdf4eaf38cc4b4477267eaf2eb012237d9b0ad481ba20e4ccb2fc7822c778a27f68d51a84c75489dad09c443cb2c44819d58a24cd822cdd22552b94a00c386feb06835ae9d28a2c7114f13e60631c8b8c9d9d237ca965bb246dbe2d93eaa7d429c71c7070ffb124297be578a749397b5482fd7c41450a798f083fdb30f631ee29df4f62a4117c01db1ac75d3c847bb3d2c3c137eb3a6f9b0eae599f3aac92e3211968b117be71d8b140573bca2edb5052b7a06d514b6cf3d2a6e5f539f5feddd10fcb0d93764cd1199d919b6c18224db93042b9b90ba4cda5f192c49be973b6966c25dfbcb97ace1b256f10aa04e061ecec1a314bff28ecb49e49ab47257a8b8e46638afc0d4cba05c9a430395a87a1afd905acb7448ab24d46b994d418cfe8c6859f913e4784eebbd1bdcc3a66c3a287b27d1232b66d69cb8a26d9d2db843c15ecdc65e26ee91b7b5697345da95bd0bdbc39a7b9b43e5037c970cc703277c53eef61debe961d3bc632ef4951637c14441d92949b5be7bc59f226f9d6cd37e6a4122a3f2c1b68d3a293c2fc164218c5882c5033f7368bb401cee8a6295bbf4bcd6b5a2c685a8764721da7edeff3941eada834271a466dbc43e3878d2631c8ee57145a78c65018b6c4fae17f53bf274e29e1b914a8d6541ae9a3a2d04b827fccca67b07d8ad4f69906f519931dc973808ada1b8267cf1af47d1e4f4b665002ed7b591350f489b23c76847fce15d62153d8a91356e03b2cf492055a0ebd2cacafd31cdce96903b99f9c3c98bbff140777ccdb48bbf92acb3b86ab30478943d2e4a0dde0c9f8595b1310646201574f7b767fd41979273ab3f724ba9667025edacb2b9f9d25af15e4547ca20c8c1d7100f778f860c9f47fe8e7a6fe03cf2d66fcefb9e58ce7b9f1bc568e986c65a3f855effd9f0e246fdd506e5a50affd588f4c9bb9fe7a4637893ea6119e25fd9bb50152225047a8da2dcaf15d481b308fb0d4ca119b7bf8fe8144237b8928291074f792858655a08616fbe72b5ef0d6cb51b65c63f4fac79726655619f27a814daea299763b02bd0c575cc55c0995d11e8030577e6e9a93529282bd56e4370fc932da47bc54b935ce5664efaea0f3d1eee491c92369a32412f99a98d1d7d1ee3b66fb81e4d07ce544318aa934dfc9b77f51893dd5cd55d2ecdb84e7f6409d20d7f3863e9bf309f76585a795168a420eaaf84f824dcebc19cfcf58d6b8524f8b9e5e3feb5a19c96ba5466c86284bf1e7f6bccc69733cc2f72cdbe5f4cfec2c6d8d0712d550a884fe3ecfa2b7ff6adc4b8baadef55033ab6a9f96c781d7d1eaa546933f3a6d2a8ad8bac1b7c5bf39ba49d2b6a0feb4e9986e922ed090ad175517c0e8b18852e339495b73107d42637c02dda43f831163d23bd1aeb898625180144973299bacbd73042f6dbc91f0db1337af017489384dfa74214ddc878714e186dcae5aa147c7052d1c22fc32bbbeb0e2bc2ffea5ad8901ab5081e4d520f9b53cede52424cb61d12712fc9c816e4a7e7a475b730d69fc71bf44350d680e87db91953d75d7c8525356d0cbf2c606f4c48dbe6face9ec65dee9200d71ef67b50d1d4995041dce1babf2fe0e5bcc19ba25ec6e5e450d4d644ed30464b45392cc902aab569d8f44f3742047853d8010cdfb00cd9156247741da71b4421a9cd285880946f93c51e13fc9f492f53c6f790c17c745a912782bbe589799119c71d8b1461c60e7096b8319af08d37ab5ea6fc13f2f212325264ae8aff24451f5289a9d23c14f6d688564d93b84bfa0a70f32cf89a0e75ad08c2ff4510b7dff84c3ed301ed88346aa199d1db171d2caed422bc53fa59cc8ce4a485bb221a7ada4a5b4f94ad397f5bc84d4f34fed112479fe408a975342ba512f159d3619c5ba9ef3f96353641203a951f90b5618a6747792e9a5c47493511f89780e493315366195798eb743f58f450cab92516ea4797ec680889d8f2cea1a718e1065d8fc734c1417f97ed29f9ad5c8268365673d2853073d48160709ed4c176c2ad8cb8997b1421f101e5a8f9f656271cf69934cead3139a7f20f906ede574dab493397ce34032cc4024b6ecbbb5fc33ce298a68fdc537d9a0f265df77eaec3e90ac740ae871e44124e888fa862dabd482dff826fbb3be3910e974bfef44770bbef9f981642fa71bf46913e6a23ceaa853ec94520911ab8b3c028f79c461bc338058d785716b2065d4515721a6299351175cb9b89e2b77b154461f75b579353c16f20fcaa8abaed556de1b256de53a22d2428b1163b70ad68b2db742af43a26a1a4daaa7c48227759524dd803946d21c583fa94e48ebcc4ef24d1234f71b4434823d8a3ab05c45e18c7703d2d8597551d5d843ca620a75c585b21059ab19bd1d19a298776a614debb15ae4148165b4d4d2e136b786c7067515ccf5175c19cf7664ae8235d7e596d528b9eada13671b79ad1ba71c754daa7c3e2250cf6cb8481a3777a22adbb91bc64d92dee7779cdeeb6273b187d3b635b58f47de847e482e86ed90e0d3a6bd7b93b34a2182b342ac69454a80f729c000ef8b0103bc2f020cf03e0918e07d0230c0fb083000acffeded238c7b59746d97712f45707fc96bbb96588d7b0310df464eb63dcbffd1deac2af998bcd0bdb60d171feeb72ed950da5cae9bc496402c97d3268cf170531cb71eba9daf63d5e7eb155e2549a1cd0675e8d5b37303bb296ad2c3c0b6ac557bec0edfc8f27ac1c9b11b455f6b03c4c3d85ccd7d2dc40ac64edaa7d02ea3c4ce428c7e582b171332538088799146d264881dbcda10aeb17533ec7ff394e3db9cfdd920a71281f385d13d2f8fbc7138f23ff1bcf0c122d50b4e8e5d42e97a49ba3fdb9898d4b767d19797b3db19611fd95aae676911cc8a6b7a83d9b2b04c8fecacf091be751288b6945e2790727435520651483915603ce5ac9c0dd8872295e328726c94063c9b7516e6839b263917cfb729baf9a7e4ced975c253f7ec7afe49df8b1ece6ec2b29289fd561f5168f2e03cdf9d972ae27939cbf9f9613e5f6b12e8433cfdfe5e9e6e2813f20b04ba54c8cf77f441188f9ed973359f0b2d722d303dfceec3fe7076b35322c482e3da161969dd62e58cb64538ae560689170975ef3bada2a20e0ad173f13da75469d4678e58fa2eab9efd699255b15a63d7a8b1b7686b2962f4869287575abe6ecae92e6dfbb2f97afd0f75cbbb573c5cd9b6ba656df381dc293bf04a7aada6684d750d1e3ded73ce48d619809851b41b8c683493457b112acd7c623e83868d97de5d9a7358b59ce54f30e2b733ae943f459d71ce088fddc9a4bd4a2cdde914af48755fc8b495f947469e2862aeea027e666126e5cbbfab882f61a3d95293a24e48f167bc28b7333bf685512aa6d019e15c3ee7c2b8cc5bda1067a2d4123ccc1256a133852967ec4327ba0f17f797414d3d7193af3d7b487b5a8ab4c70da84adaf35d690e9366413fe4cc8e77d9a2f18fcd8966b34d4c6cb133e655becfb0135b95724639dadaa55137ae8f4a2f4d976c6d4c895a5dba5af2c6cdb7e6bc5df2369979734d282b05fb0c1986b234d19a48d9fc61179659712ba273b895c8c852bd4deafa5804fa728a376ea27d986c891bb366bf133ccffdec8a78a14bea197111e9bacbe24ac1a88e41b74d672ee58b98f63644f99d111f24649be9b065174b714ff855f7698f868fd43806e13cc84e8bb1dff5c47d5c896530cebfd34bbc289bff5bafeb0b8617e6595d52d7e6040ae73a173660294a92659b3badb264da49e9558f14cde2abf74c6774c7c3157591976eeb6feb98b41e745bef141f9a739d0d156a666d7d25b22479cc7baf5cf28a3f0d23c2697b5fb0ebfe3e6d6bba5bcff9e73864f4c92cd72f6b754975683fde97f7f6ce4e2cabc1aa48651aca108cfd5b3f914cda7e745be70fad09526e7c2d7296de14a6887fe5121efd977eeb1f451fc992af26586feb99077f237ed09fa9a92567c0d8e1913b93534b92a6729d2da2b8a3e184f60ce8ff8c0111aa2a69c1198bb337da50c1ccff11e1915ece8d33949c5ffc43e6b915393f3ba282375e8bbca93ba3d787bf7649117f13b77c06ef33fdbbfbf799d10f17b405ee38b2c328a6161191d4fc9e570dcdbeecef7798787f29fa183ce4b00ef53cc77c2b45baf8ef2bb571528279eb37a4954f2018fd66e20abb88cdde376f27314e26350cbb513966434e734953693dde372e7a887795cb9b5734ad84d82003d6ad3a9279b39334b6d1bd567ce286a3c13613f9915a5145a89eb4932c49e57692b07bb4dd3bde1d68104632c148af7fc6b4156610c3e16aa6ce2436d64e459a00bc8ff096cbd1707a8109251b25742fe3f92d42eb0c01cc70bd5891e895eabeaad5526232df73bf634ee6ce3ced09c5b2da7cd867b48888cff7a89906bb93b1361159f47ad1106e14dd9ba962a4c79157e2064bb0c414c62caa76ee09610344c7a5a42903cf9f0de718f2b89b57624f9450e2c7cb4e46bb3b52d45748f2b9fd92f2e3dab31cfea8f6ac31d913edbcb7f37651a3afc9cde6b0ba0b2fc3ec4c5c3bf715960559682b7510d6f7308ab1c36ea8f612486697ec875d6298079fd206299be93d954649588c91aea36d0d8d6dc6da7184455f433f5fe99ecacc9520c5aafcfb45b72be87a34c13a5d37add2b40924387ef23887cf9e3c86cbf89a14c946bb1c29ecfb8157cb33a25306c4dc6cf474d51201deb1016154001b85b551b1f732a7918a460921c7f583ae1f716764a06bb766f72664cbbae75d0ba52382653624b2028f15c9928a4dc9a8b0b1d52211e1a73d010d3f672ee8d76eb87c8169e6f6505634753bc18c168fa6fc8c9ba6a170a78647c68e10c4ec9728301fa3fa416f579e1ceb2ea4b314a748444c22ac24a3450af01442743c1719dfbcd4cbd8f7a160fdbeb01e35f3853d908f82eda1b89e8c4e0ece62dc999eb8e09daf12fef9337730fb3bbc205e254bfae6a5f8cc9eb8c05c6644bb0f93ce128c65d658d3dbc061e70b61a2321734f63d6eecfe660f653c53e546f90b22e65dda536b9512b1f9b244779465e7dbb14fd742692f86d9d4893889433ba7f23935d320757da742e8c7d4987259ac09ed89626e5c161b639391252747e49de389bc3d3dd170c982bd324ad2ebb682f1aa96506acb75ffb00acf5ac4691ed70faeddebd4ecd6846ea17b1b4e7c15c5345c4616c949aa0ae23f6c2f979131b60638364a32718a079fd209299be80d101b83bd48c05e52aa1f1a6303084bce657a89d56d3523a946ee2b5bf7d9dea87decb45665754f744b6ddd57b17d6f18f3ead322de9a15ab8261975db277f77dc56d4e23e7edef70f8a4fd1da3dd0bb9dc77b9a3b02b8f7a12cf56309f3b41c9a295d8b68a1a15ab709d9167a6e8469f0b97bbbfd113627ba7b1cef5dc9e00de361a7e6ea828d7ff54492567d233f37b3667ee2c38a19dee0c2b03b3b7c3996be354b25cf6f66f48a366242ea84a5d01735da8854a0ade518696e6677a546cfe00053b3f0a0b7eb31c7ddd37ae75af0387d1edb08767281788545c7a7d0b88683c4ac15452f819bd9a08dcc7e9f4d94e1fd9eaa7785fb5266b9453e713b69c59b64c35b3364ec4aa955361e683f12e4a6eb504c3fcce34981058daa776719fff7a8d395f41e7867ffc1ec7cfaf5361a8d45a73914cb7e371b899cdadca531eff0d1d8caad0e7a27c7bfe1ddb66fd8f467618d1b7c69fcd3803330a21cc1ba067d34a3c5f746cd19cc71175e05ec6bd9a3bb1d6aa2964db657d4c513dd68a9a83687f6e305d0d3b88fd6ae65e0d2ad733eb1b9cb59729c4d22cf57e5eed63db6dfb63984b376540de9e2b03738c1d9b518fd5b849df2bcb9174332d35126d0585b4c758a4ada40851254b68cf53a4e83c4b8a2a2891f6142b32b2ac58797433129d627b95c7e360543a09e5593ba13c5a2b521eaf11c12891cab37211449c62e559ba37c3ba3be1007d80529ead796cbb03b2d4db3bb2b3980707c51539d588d9768d34aa3a7a35ea1e39636c87bd43b0be0389e6d2e0c93528d0a44434f1933558df8eb4519046b783e44a548b6cf20ee89146dd5029cfe0e24f240fe6e2d16681eee5e9f7ef8cd950d294d33c4937785d3ac68e6e8e4a6c8c1fbceaf839ce098ce53ba608b143fca39224ed745d2fccb0a4d190411887897b655d977b99472122bc92c97e93f6f2ab59b208e29ae2478888c6ebd9227628efec2c7cb26b5b7ba69b894b99264fe6e6a5256e6f54e8ff40989319a70e24cbb0f7861638255186b17737582aa4b710e3d6219651c348e6f261f10f960a434ab82919dbe7e638e3add13093cf822856d71bcbfaee30768d4615b75208e5eca9bd823dde3f58c95c4921cceb8ade30df57dcf95937ad04df146077307b24bedaa9e2de0a9d254c745a87646f5ee98ddec7e4d05e155235c1283a9c8d34b4f96597a7795551aa4c62e895ed10138afbe63b323a4bcc24d5381925ebc9aff54ccf65a4882f6a52241635c3ba2c626c35e270b1512f26bde2cd36af44b3dd6b95f94e853e91c092e31e2b677646f392871045896c6ec5ad6442797c2a11ebd8bfd57f7542b1aaa845915ad4c6d08d08cfd1c04fa4aa54ac876751d14351088c855e2c36776fa82c81084418a57fa5543297535c715f3979593181fb8ce5c7721bb1dc7535ce327a3dc964d62090af09e46b9661a9d761a9a106a98857dc50242a1a14ab14b7cc89153929e19951546e857e2ac1acbffe5445ca1d8465ad60130963a327ca6f30275751b12c1f4d083adfe6e8495d2dd6d94f6740032d5ea966e84d07d71b684794807bc38ac57c8fb4d0a3a2ee97ac8e9d66f1972f5999b0d5d2a254f32a475ffafa70af46fcc43eaca941bfefc3d786672b9fd47eeb13dabfd1dffee51b56e8454b6f2f44ac4ce00e1b4935e232329aeaedb2fc6c62cc76a47d8eed35767dd67ba5704d05969193adb146c2c9b6ad46ec15ef75c32bd1ab81938da9216534c4cf3445b833f936f7e47cbbd71be63b25ac4357f1a9c409af555eb7bc52bdee7272d230ea34457e86e5a4c52245ab7b3ad022f7f62a6bb9de57bfa6d2216bdd993595570c632a2a6edde2c6c611db7d780eef43037593587edda6ff22a9e7f7e5610ff8f540880f328b22f65c545c28892713f1fb605c6b924e5be04740796e562edecbcca3d06babca4daf35394ae1dd40267f4a00fb81bb56bcf7749cda2ea897b4193b69b772dd24dd14c34983e173cccd1045440916fef6e0da5a8f71043eb1fc32273aa724654e8a3f8b4f9684f3216a903c7cfd2d3d71781fc478b7a39ecd3d02178764ac708e31b7a9c78a6bf17c6ca31cda38c64ecfe1345242af756824fed6408dd4a40ed608315248ffab7f7db96e3be3db2481d97474f5ec79063b6f236184480ea32ba745554663871e7d7ccfd84113867b07d54517609f26c6fbb4cc187c625ec29d99efc9653f9f98aaf9c24847d20cccec8eb31bf48272b6588cb5a31c2746c64e6b0fee892215f66bdc4e518f78ba903b7b91d1c807f43c9ed96e87bdb48347dd7a2eaf538ea81ac542a5bf18e1d364c5b78a544275ae973bf1e9a49da6fdcbb1ef3c6835e412ea3d36af85af5c6aad1c643307e8d71c1aba7066a086ca960ed6d0d60df8fd231efb135578d407ea26eb7e2abe1dc19fb31efe376747fc896c16966ebf8d2f23e4f870e3b36d8a2a15096f873f20e6bd58dcdfdf62e7d9ab020d85352e5bfcf1ee7f3185329708dc9d2035b5efcc78fa93345e37156b7ce2db9acf1c2917822145c2cb7ee1172c8bd20bc6422c766673b953364ea2b04d8ea7f80cbe2cfab95fc6ac7df87c349ac567f0f88c546be2bd4366a245e1467c968abd04620e84b5c5bc2b71a39265349df57d9e59a534b723e6c53a746a09135d07b1cee0f7043312336b4587419ebd212265b118313f489c16aec2fddd935b58a3881cf3ceecd4c28bb35f019ce8b245138575d213a78d056f19d38e8ac232d44c52a753081de643d1c1719d88ca7df69f3d9b8dface6d5ea9ed7916134de0b355af3a6c19d80665a61011f30a8d6350775c7f8f6d6ed3c45465f138e2dc574375e9e38375f9b1d5650b11c542cb24b41c98631bd5de5114f6f12fd0326b474bd44cbe5d8ceb8fb11aed12ce02336326576a3f6609db0e698be8630ab9e62a8f4e2366499f0bd7a847da8a5e7aed926d99cf7dbcf3bf92b320871b657571dfd949666579e12ce9e1b0d64ac7397574d3501b0cabc19645cc3b71b1df16c3b2fe8d2d72a3eaf34abf8565d5e39281867f57362b861b79eeb9eecdc123df3f274ed249da600f9f82f7ed13ae08f69588e3692a59976ca43b7b8275fab056b37ffee4ac4cf72962e675fce645909f196a071a55df695209e6516ab23dd5de5d41658539d2b38a61ccc6b493fd25e3df1341c99ea80aba21ccf64dc7231c5b1b731a5fca5fc1ef7d3d7671d17679697c8215f3d4ec34d6bb239d1dc75bb04ebc5e1411cdce0219b9f8ab4cbf5cf0ef2594aac0cae4504fe3bb0efef581ba233a49b3d0bf58ed09885572c4bdf2241c931e3c6dec6ce80dcee9405e2b45332882356cb030633e159f36196e89ace2dec27776af3e6d32aff5bae776470632991bb9886972ed293e562c53c30eb2d98e7889d42fed641cef25eb6ef9b273126fc6e3f955fea0b717568e855e8dc4dc821bda13e25ed32a28bffdd38a5def1c31ed5ccdecf0906a4fe540ccee41284f9d42155423da99c41a0a1a4e9bbc5633639c24a624eeded551466e95c8b14e665f3fcae1a9d78f9aef996f537379e970a4aeb0d9644e0f6574cb334c62a758561b82f83303565d61aa416e495fe571356775945b6839b298e4e81dbadc6466643974ef6ee005d1c0fd3d566aee87956e6bddee7bdd5e66955d37a1916a2601e29cda64e44deb45de12b9b02b0edc6be477c5e66a09abf68e0b080b36d9912269591e372aa7ec1fecbcb7fb76fe2df77bd5e75e025faf81fa78572cc3a728c93548568b53ecb02b96e153142ea5135236c3aed808bb62193e45b955fd50561b4078d335fcae1876295e2b37586c77ec8f5d6057ccc70883d6d2ffa21fc24ac1cfe22b07ae14f4c3c12bc5b40dfe0d47b8d5dcf796e4ee141df323ecb56a61bd2b96203c63b3f78d340a1b7328c869ba63f731aa64a5edcf54f7afeae793a9a4ae3c6972619ed10afbe94f7049459d8ca2b22614c3b3585147a86ec747279627ba26f0a7e1d8fbf09bf9e82643ee249de19f463a9d56d4299a59b5e2aac39fb037bd8c82602616d6898e92a44083bfc3f32e12778535d3676b67ab857b7b0c73d6b24a93bd17a2f0b2b7cf36e339c1a9cea9196623272e1249565c7d57cd5ec4714ddf1c22253ec3e5300739c70153f89dadd26b1c5150f93b8dbe4fd73b348a6206c56b377f1faff135b97a65749da39e8f7a60bde45f9e5c4f18bf1f1db5b2e60e1abf1f07d7c2ff0da74cb5b8ef35e3b01d67fe8267234235454b6af13bbf793778ef4c1e259c3b7d37b6780fad3c423fb6ddb53f9e54cfcf93c53784d8b24d3e8dbbeb281366e5e1c22aef21acaedf9524c9aff7f6ca2497610ee46cfc3cedd58779dd3e14eaba3825679bae550af362073f67d83d154c4327be9149a86e548ede70a5e5cbe640c31103df2eb5cc340dfb3af56a4e77c9c3d2b6af9baed71fd34d176c016d58907385e54b26bd2ac407eb4ccfe1393ce50d6a9e69263cedb8f2aaccd98d149dd271a723f9f1a2935214adb7505db02b954e70c4f7468394ac12dbc6cceb91cf037ed2143d1bc9d78fe6eabbc78b6648f15e162d6e9f7ed5a217a339dda10fa7b70936705f345d0a39cf5db5b06dbd539a273505b6f039f177576cf96433b9b964d38a959f2405d67db93d96358c13e44f9249a564b8d8f66ee46f326af762415fdb64d0255308f74e2ceeb449544123525ba432afd963937ea16d8479591d1cdb4e325baea3837335778ad68cc933b7e237bdb56483b502724450c67bbb040567b49315b5b0b7912011f3a31321fa944232c97a916ccb5cc4b83be1678aa23ffaebfb236a1f2755fe7fd3c2677985ffcc9fc7aa47179fd17790b38097ededeb8f0fce35d81dadcc7aa59ddc3d6f1670fe24e7ccff21efcfaccb362c6d12cd92908b5a5e9b230acc813973182aa99be57c3b6c96ce1e26525f46f80edb82b6d8e69cfae5f5d8c28ee9b4337388911733a76a6bc4c890bba7a6686eb89ad963976c9dcabc1c46cc12478617c55b8689d1c1dc8317b5d597506155349b5dc897de7f912bfd9e5d6ca490c8916ea4b22888f46c80699cc6a8c2289ceeed2cc6378deec45a0e168f55dbf6d81f654ec5333a2271a99e59b6f9eb7bbde9b6de123db3588c34ea59e2ceb0ad5628b9dbde8df9c7543a5ac99c9961ed7fb6cd0ffb5dbd0d955ccb39ab09d6595bfda8f76e5751fc583531ee602e936d279ffc2ec52149e654dbfcacc7ad959358b9923bad7a2f3f8150fb4578cc3d3c77c2020b4df5181f778ed00430dbbe212c747b17bed3c6c43f242d74c123869513f937bc3e8111a4ef91ac4454ddd1fbfc7bad5628f71b2e675bf1f03194ebbe51895799e81b5f767ffdf07a9be4aeefad1f5a2022344ca9374a0952e67c95343a235149b24c2f4733ebb5d5342abcc5af1bce298d5ba3de2c7d53f2962b77876f21c918707c3bbd8e2ccc5e395d579273cbaa556b44e4cf4a92105759942ead644fdcf90b5f366537cb2441a48327be0fb1b54104256510e31397b742c91ba48c2e261959c370993e802b036bd81c992e0785feccfc8b46b834dea9c992619707a5437fc6e76d30130fe2caf118d9e0c2f3f00ac35c8cb40e318b69941977fa42a84ea266d434c2527671f219e9623a3007f83897241b73e4683ac787551b25bb25ccb06b2e8cadd4cd28c9a218d76ba3983ba5ceb661d43ddc7388275b8cd44212e2f8c2b15666988a60508cc8e659fd2be68dd7c109c5fc1396b7951c69e52939faa2921b4718113ff5749d6d4de7afeb9d263aee32def8553dc6da9fcfbcd189fa738b7ff9557dfec2f395d9179ead344a2e48346adb986b6d252b8d7a4f140a724b406e9b7b759b51efcfd19ec8a0f683924112467c6d94511226b13d73adfe70d4c94bcccb34a2d4a72f48d5b261a09d22bb93533cf30a05baba4a0653c5614ab2553c51583f2e1c4d3a043c68c6f9da70e6662968ac45c210ed2e1053d036797b9da3bfb897ac5a0a6517d20c758d04ad41feb59faba03dc24f1b05a34db18f64d33cd0dd7dce54cc2ea5cb017274f113a4d96f87b69de2e759293c1b90ff5eb2b00f9f3be414e6c89d352437eba320af2b7dbb94f893d4214a3dd10bb823a7f82aeb01f579ae5d16348a5b8516c36e58b52a31d833a6c9c2a53aea8c221e3f9f6f7afe3d4b0e8d18492d6269ede5ce5e4d23b66b95b571252b39d97ccd3a66c3f9fad96ef8c6e0a4b6290fa7779faefba4e9727368fd03fc6d451c7f8e94191baa9ba2ff6399dd850818815a4664fcf65d84878d55e3db7dcab19d6fe372cabfd7be89f3b8e783f49b04da555ca466cc1d880ae0d23eb46fa9b6f695f880de42a09e582aeab5304d407b6f5a4058eb49fddf03da5c345c0b773b5f0bfbea8e29069f55546fe2f0df1bd2710ed7a61f9d4ea0ae07423c92179853b2723bc3dff34a3a258cfd39dc03f09c015cdb7f534432960ef16b61969cce5e792c70f2bdbe9e89be8a38998ed8d772f810bdb64fce627a2d81f0f90e7ffbd72592196d456c0027c5b8ce548dfa84b527ee607fbf0ed1ab096474ba4af1dfafa5812c3195f8bd06771b7f468e9349cd9db3d41023659b1f8e386dd2d6d0c8b7698a0ef6e388cfb35f3b6df2afd79ea2d111ddecbfcc7873eaa689a9e357056d9434679bc7376159646c24e2cf9bf0fdaf403deee9033f74541e05f187a4d12a5771ef09ac8e3b3444315fee88fe931cae1c979f747aca76bec6e5e30e2f258a711c35c9502ec446073fe5a3a72f9b71fc34a5e9a46ea61041d5fd3867a5238252d508f5ffc54750f3d63822a8f29aff3e820afb6e680435cfe088a0026bfe6304c5efcc973e2182e2cf7296fcfb08aaee6a7f0435f8068994d3eb74fdb19c49397d7a78d17146197f6f40bcd5f4bb72518e727577facba1c6a1e5fcd47dfc6e0de067fb1dbfb03e7e8d03f8ddf81dbfbe72f1f503f8fdfc3b7ea17dfc6e0ce0f7a3f6670ae15dbea4d9f83814ed524fd231bb1f8b7786536aefef3290f7370dc8f25d3bb2d4aa08636f3b6db9568d7619645b1e12de2344c8f8f02111face2cb91531db7f11ed57b10b18b6929cae2f678fe5f0ad56cff1cd1124faa1bfd5e26f350bbc979f0f6324c3f10df73fe1374def381d336b4f3821f09eb9474c15543bd25653c8fbe96988a22a0aaa898aa65308df5ab65d6c782c8b78d02bcb7806c9d264c8e83103b9de62f60d270d51ccf05afcee19d5926c14e3598b2ce6ed84e5bbede1c70a461fb2989de0d929fc5aa5667c75a54d3ffcf1c902e5510fa2df7b24ba4df54fd59508921ffca3a0a123322a12396e46c30e54d0d6ae5c57acabbd76ac2b8690798386784d6520d9635e53c16936b41fb4d549f4e452ea0a7b32c2ba32524124d61c4444d2f3a4915a4f52110c757e90de54210ebda19a7ebdf9541111c66bd63043f550adc9400b474c8c54249e5ea09d41e1ef83f64e47156c2d0abefe29fe0628ab1a79e748904dd5f898ebf1746ebe48efefaf9fe093e8bd81fd9d52f062e5d82a53cdeb785f3187e92823f17cd2cfe1f27a619cd708125a4ae25f8ac1bb4a6e4e3c5616989d254f22b03e3bb2b3fcaa8579ee6933438cfc28d9bf1eaf3ea126d1387daf36a0a6b75c47ba67cb89ddaeaa653b853b4a6dd6ce47a4454f3b9d896b27435423f0fe6edccd787cbbbe22ae8d9c93185c5b4656749691e63a425554cfcf8d78c665abc2474e6265922c894605967f953bcf5d56122fa3b21e61f930cececa9cc6aa993b65243fa6c1ba6ac450c791082c6f6403d6c11416f363a929f8d62bbfbb6df55d999d74ab92afdfbfeb2aeb75ecba80e3dd326494fba1108890430b14e1dc595c15962a3306b8a999fb65c899b24261d86d47102a2a77748d3982526db5982ff265966dc850e538de8dac87dd8c58a37266f95e142f24a2f07b6099c8b649e684dc6471b161464f7ff084005484f6ed3d5f5034477b88ea9665741096eb7a82dd71666f29aa68f424c6d2cae26bddce743e9a6ed2fad3dd965a13c1e69e3195a16b794a9fce6ecadff694e4b71d7a421d42fd61e1d8a89d8b8d9e01a87cafb2f8e4f09d115400ecf98b4fbad83c6a1e97c6f3dfebc8e816b25ccfac2e8348b86544660cb3d24a667bc843f02e9d5ed3a5395d600eb74aba518f27e6b8832e3765e4992f3a34015119c9dc2b93f49fe92ca85f5487394dd2f5c431abac62239d4513f39877dac9725d88f31f161aa548e44d4939ed7e6d2a8ae0f612fbf488712ac0fb285ab0e14e6a826dcc733d03dea0b46bd4fda7ade4ea50169f11f57037928db49b98692823712462898b414fd1a74d3be89000e4721a46878dc2da8bc9c3df19f6cb0d356e9721d203c6d065ab26b4c0a56f741f001719ed23aed0db49d283d8c37f0751e3526e7a17f8ee84cd195766aacca416310b69e7e73648ba7d1ffab745b72c68c6751f4c080bb24a908b2cbf164dcf0fa17d90af2932423481469a71b2bd62927857e6e10f63923f8798a0f177bf28a3b39cd242d44169c9e22047bb7c9b7aea18d7a69991d66c4f9e544f9a4a92acc02f343ff2c283cde22003be09bffd41191d94b67b5e90d2671c7173fd9cf4927472ebcd9449ec58d0cf24d04eab9ab959369cf490abb97eecd9aa990916cd1a4e9bb2f52174e442c5ab5d969f76b9fc2b3b0b53af71d40b7d94a5c003b55b7aac0eca0fddb554f751d3d04f96cf2a1d940a9db37cd597178357869e98bedc244cff16d3979f81e9ce97faf2b92fdbeebfd4975f80e95f0afaf20f62bab2c06a95442efc7169e6664bc109e84fe7b6aebc9f76fde387ec2c3edd52508df05bccbb56077d0d6ddd5c5de9a01ad086cd5ff4e5b5a384cd5ff5e55144f8e6effbf23c086273525f9e1f114277f726f5e54e03fa616f425fbe0ae896de84befc18a0eb7a0ff6e527017da1f7605f7e06d059bd07faf259a051ef81befc024c3ff6ebcb3f88e96ebffe5e61ba6e6c25b71f6e2a034b157cf6ad81e38b4b1745614e9972cc13eb6ae7656ce91c9f2139ffb8fc13c7bf287a488d2b5ddca828e2384ba9ad12a881b681a97edbc054bf6d60aadf363035c83638ae2fd47ec88ffc20aeaf0de2fada20aeaf0de28a29de6262fa728556faf2050bebcbe72dea255ea7b1432ceafaad737cfa108b8a1d6451b1832c2a769045c50eb2a8d84116153bc4a262fb2ca82f9fb7a084be7cc182faf2790b3ad897cf5bc881be7cde420ff4e5f316e6d7972f58585ffe094c3f1cdb972f58589ff678ff2d3ce7a079ff2d3c113e92550dbc5b1fffb12f8b6fd66b548ebbf511a78cf884c45626c1b18737edd7fb939aa9b393f86d8c1d85d404203f79661e650b517f8732f3c6d80a73f7db1d5fa7c67fedf8469fb71d7cb2a1a8fdc2eaa068e28bcabe67f2272b9ec16fa9197b99bfc3239217f31ed137df2dde65c036d660f9224ff10df6053e75bf015b97b173737783b53f85ebb5ed7b4e2b458b3237433448773e836dad2bef8bbca2af055f78fd9ca10afbc62faa4a078dad13eab6402bbfa4f0f5979f33602b63b1958de0eaff1c6e75e4603b53819d357029e70c45cbb1fd84d0adbdedfc18bcce7dbfd249b780b7fc228ceb729c163e88e78f3f4fe3f2704e084df4fec8f1c9945f136ac0a812d8b759dee77feee1467476443ff78917ef9ec065cfcef93df7b39f749d18c8fdec9c81dccf46e1349c875ba008aec6e50de71c79035bfeafcb2f9dc02dbfadee6f39b586e5ca7647fdbee5eecb7bce0d6cb93b6a60cbdd43b8375f1ec3719f3d7f40bf3e97f29244876fc6a998336e8193f2ca4f673869223ef1a8da54b5a71d78a45efca2824fc32d7d22af32f223315bdd5f66624de6196c737bd44c338e27789bb34fe9b7396c61c2bd190f4ac53f2949a9ea271c8192428e7b48f54e0222e34303ef6d2ca88748936a77f6fbc2a06650bb0bf7db3af30895f07dc68a7243df1dcd15e5ec02e139ac897b53c63d67c597f7ddf22f1e5baef375947fbd9c7594096b1022f538c26ff0fb6c2bf45574588f74ea2cb56c6b17b27c1b898c6d6d224aca8abd5ffe003dbf1d4b4d89b1dc27ac7ce91a74497de177a561c6168357cc7555132a4b6d19b12bd7966b7fc8ebaa6c29c4ddd57d5fd6dd114d1013e2b968ae83076e09f3797e3be187795162c24a087a7cff2e37b334974d74685eafe0358f671adf3a5eff8ef76403bff789e8a6540369d12da9aa9a9772219bcbbc43fb13aa1b8eaf50bb140b712488bf1cde95cb0604c7b423c26f8d158f9f10af3ec4bd2f7afd5ceeaee2fed4e20e3ed552ab463f0d28edd3ee48a789ae01e9c50f1ce9356859e580f2bf72e98b2db521683fb43f2ba69d9c36905f8b233f19550fe477cf916e4237ac946346fdc1d18a1e692aa5422afa1ea77647602b1f7dc8915a5ccba76249d900fc9efc25ab23afee1ace3babeee246fed07cfccd33e567917b206c15de6013b0167139de312cfa4238d1ba508fd37e7c1dc7fd9956c7d9099f8625ea3ff972a4d1c4578eb787373869d4371c741d4fb73ae85f781af810864a47df6b109babf927a1dae338e9fa91f0e379dfa874785d755fe9da21a52f7ccf973e1bf1b1f5f7a5ed434ad75d7794f67802efce21a5d1b78ed2130694763c1dae1830737c2decbb276f8f809d39f79c0ccfa17aaa819bd116596a0380fb9e7f1ad4a628fceeb863129f8e77ae67bf76825ab84c089429bcb80b3486293550b77e61d538ba4333dc232cd73b88bb8f151178b6fc2c4fc1ed96c247baaa1ce74ec59dad78c7e183ed0ff64d33cc7faeda94217c4fbe64d7f6fff1aff6606f1476e45c0f69d96913a536db84bb2334efd3931cdff0f909522d977e26e853381f0cebf66507be51e7b9050c97b94f4325a6224652efb883744124e8d2b5c4c47da9cb517aa0707d9cc2df35f4af8faee3ced985ef7de2c718414a7e4755e61c6a62a3dc6dc2feca29d4e4c594eb98676a913c92fb7d166968be53fce86a41eae9ca2071dfedacac0e7c4611cd96249229fc99b06f1dcf472dc6d2fa9a1403a4ad7b28c8470c966f3825e88b2c376d6782a715e36f5d69581be3140d5e9f29ee2a5af1179bd9598a24f31b450de65be6375cec3bef2812b6b7b2b4e24676967b92578a6283f9b6bb3d3f99319622b3ddcc400d32536eb66d67f8fb05f83ffec4c8ff2bfc26923f356af84a98877db8df73e2cfc77feb8909d51fc9f97b69ad8bc69f3bbb7ff46d44c14d568d7ba6fc6327d70be587350fb993773577afe22101f215a919af0ec4fa73697fabed10de39a8b97ba11d04ca8c6555af45e0770ef8d4fc98feef019dfdef1c220a6cf86c5cf9c713bf72f8d96bbf72b5b137bc2ff915bf73c8ce72523385a5880de052cb3b5a34e0093d71372af1efbcf127f2be7569e3a027fcbcfa197f3244b7143132f95458dd4f9b4626e33305624f493cfedd9eef2234ef9289a43c86fbedaa9c19c131d7c8fc8899053239451246f34562cf77119f5ee4ed50528f5b719ce00ef8f2f4a5c17959366983f0c40c2875bbef57b3382dab1b7a62a70f7aaf635633f246f18f11deface5e7c1eaa0c6cbc896f2b72fa2badbdc9e162fa669f4e0fd17504ea6f17fde8d130a0bdd7fbca7d40ff3cf4bd484625efabb8b6304355e3b825b07952d394fab4f5e220c78c8c4f1a4b92e724df5c299c371e17ce474f98eab89bdc2f67c608f1c92d7ebee9fbbd2c7bbf8fd9b78482273853f98c300fde286c2c3765c695c49b39ed82c799bcd6c17fea1eebb20d39f52575fc5bffa54df83bc3e5f52bea1c5fea5db811982bc8764be63e4bf0f8e4af4b4c66c6348ffb7eefaa299a7bff9146d1665bb0de80dc19265fe2ae0c0a20cc0c44644f750a5f38a39f8ce22c970a710119b84333dfe385ebf9fe2c3b4c98213e35ea74a4cd9cdb0b65c80af13e52fe1afe159b17f4a657f16fe87c9e3bdcd9bf6885631ea82eb52c77dc75bdc4ffa6c1c177fc85df2629bec8a7b026474ad627c2ef1eec71a4c4570976b1f26b98c9f484d0af95a1fb94416f0a145d837b299a66a070cff8b49acb388d492b43db6d463a8b0ca6da49c02e46ca808287fd462e2d8875b47956b0dd5a613eadc673e9c7350bf215f1a7d669430c14b3a1532c492c8d1f7cd3804c4d10ee8d6b7f12e6af2a5cf344a78239ced5b3dda8edc0da3d5cf9fb7b0ab8767616fe821a7f3d8def09e1b75903bfa016e6fc4b78be14f85b317fe65dfa29e3537e429abaf23af86da0c1db450e5ea02798512e12a11f8b83f57ae4c59cd77931d4453689b7d3a802235b50c6db2abb4b68e36bde1ae997f0ef2bf89af2193766b7a0477585bb0d6b92d32c3f8edf9860fe37eac6592bf42f134511bc75cd5b2007eb923947976b02881799d5dda4d1056cc8a550249f0fe9c3e6479be663fb98ff6105bd03f95a4a2ca175da9061a8883968bb9edf135774c1779f36c419192559e4d975f86e0e3cb9044bbf27430b17146aa74b1158e8835a44bd288cefdf42617cf65ca45ec46fca56b34ffeda1abf37e35a59a73da727b4a5bb1093f123ba9e9f7f615ea591dd8526b1931c31c07eed4957aa24497345c6ba8a04db2b2a49129dd845694f0e434c5b29521efd1b72d8d2ca82050efb3167276b4feea27633b3d7daec1dbf522ffa5985f1c25fc032c48b587787ad4b365c69e27f89e4cbfaafeb62bb973e5cdeb6a26565f3eaa6b58ef3f483b2d18eb1ae315fc19ecbdbf77eaa26b490552b83ba10fe9583c6c4a894d214c9ea9b6fce79abe42df2ed9ba973d694acc1bf7b70c5c48f4dfd1ebc8606ebc711ee8c8229df91bfe26c1a73bb1639312e8c91652582c5ef96819f07eb769082bcc6607d00219a09f10237a6d2c9ec1ba13b611cc905b9f26761145dd7ac37e6feed63133c1b777d985221d927aad0e7a02f41d2b135e6e470f1f47cafe405f9663be30e96976cb6e3981d7b5d85fe1179257f456130554e86162c2d502415ad2baa5306cd238ae2a17fcedc0a3abbf31d572b33da19adcef9995deb98410e653e9550c9ad11fdb3afd1111924ef28078f28fc5c903f3bb4c02b61f636969eddab48e067f2fe79b738af2f9ed0e35a0517f95530605b688122e1ecb63d9fe3ba3d725cf7ecb6425b5abc380803cf67d906fc4537febe1bcfc0fc37de4772d3027d50e612e3129548b6e43364eceada4604066f3d8c8c4bdb454c9614dfeed8c6ecea2259f570e9cf727c03d368187d8198af89f43bc45052a7be3d6c36e167a1d95ea3f4ea85e0d15da8c27038ec5625434b254639f095b66c739d5f1569aba6bb8db5f345992f4fce827dc6b6e0f474c2f8afdf441fd7c8703b5abb84520f172f972fd969d4cb2f106aa3e71fd0f7ef5418bac27a3c3f56075f7e93601a6b25263f7c2741f5ca0ec991bd45738ec04e52338f9a7fce8a5b91cedf6f75fdd471cf396c2b2f55b07b1bbe1372c190976195fec328bf84982f69fc25f736577555644aa5464da95faac4b454bdc1caa7bf649579e810b3c5e0d6335a13257b99222b5e31903d711ae3ad3ccdbbc19b0de4653678bb5c84630ce66d9a083419d987bd4c721978284d18d9a6de4053304d8707bfa2278337ebc98a1c5a6494d3e41c3dd35d8bca4d321a4adba1747b2dcc5c4dbd90924f9105794b765684b4a065a081ae3f31312dc3659bd391eb45a91adf2e67c4b75d5cd5ccf0dbce8c9733926d6ec3ef6445b568a458264f47fc970737e53df24ca82d0d93d175db5cb398d73b9101ea3c72daa566248f9c18cad929f36523e419eb5f469931781c266b12767d2d97b9778896ed0adf557821add81dfd9b9b699e5d6029a351f5b9d89c68dd523de6dc898033d9e9ceaa6d9e9d6d442455b23ca7c16aacd7212212eb72432515b9c09d8872557f5639f6f158f19eca093fdcad9cf698cffdb032e9315b49a9f7df316e4a47befafd9f087d1d76db09fa2abaede4abc73e65dc04bd5531ba93a0ad48946094a9e588caa55415747b18ccb422e6930e276f168f2a121bdeab88fd00e1510f9e9a8562761a4187bb2e1a78bed42331c83be211897568e475a8c53a34ca61bcbfa3495c8a8884de90f43d63fd38d47ace571ffe4846eb508ad557bfe4eb9f2ab73e1a2bfeac32017ae19aa551db86d3b7659deea8aad2f582d006f1888436e847c823929138232a7274b15fe49ac7ae59989f469d72c22f32e3d15d2bd60bd601115515b9ff5c3ff5e189277beb03f0d69e9765e0ad1f65c9b6766dd304deda695c029e3a42ca5933330c7bea3be29fe53fed9449b19f12d11e87aa2ef57dd53397f707197869453e6887fb12e4dc25a3e91292713e1a1e6dab79b28f1ef89cf351dd937df48a093c54157c792b21db2e474cc33567de4b0f8eedf75202bc94ad94715e7a708097d6850ef5d235bff3d2f0e804ce4be7095e9a2278e9bc013a0c8f7e923533626794e6f3d4bfb1e7cc38c268bc2e268d3162b26be7d69dc1543e19accb016f3d4956b005a411fcbea4e0483ed3ae43949a949fde9bf932b13bb85387127691f24093ccdd8434bbb1952d339ecc0fcf2b1507d7d723ce1b97d24ec63877446d075fa61ffe8959d8e2ecf065fcdd3893775b02f66db82d61ccff8d2fd34e822fdb1676fe0a1e67e02c58f348cc64398b795f96ad5e8aa4d60539febc4f529da3b0b7778e022b1ed5f990887c8ef3c9d0edfb2b5ffc75ac786be54b3fdfaddcfa2bef815f59931eaf19e2819c84b99c076a390f2cfc7fc70339be2c277f1e78a0f9c91e884b711ee844df94ad0e447e27fe1b0f14d375b2cd4f091ec8b5a1e13c50cf7960ce400fc4fc34eaefcff01ec86be04645bf15659c7910005e16278b032fd3ca36776e334aeafe742b2f730f73b91151f7f7dfc1bba131b720359cb9d248b25144c0d79e322a28e25adee8fdde74ed85e06b6508bf3f21fc0cff64d569c572846f2610aa9f2aabd477013263daad8e3dadeb173277d891eeeefbfdc0e1309a1186f7647450c42caa332cd8fd03246befdcd613f7913673e7228ff05d7ddf59466ad43f59f13704f83ba2e8bac514558725b7d259c87b4906d123bf950773c4084d80e5e57642468d46b27cd06c46c30862f7c86a19259db149ac516b8a995152123ceb1f0e0990c442c708beb87be62cb60cd6f1b11742e830d49547a91678e0af493689e7ed7c9796512ddb6419eddb6472952833067bdd63f725bb54bb0a2fe23ef3df6ff2a727b8245e5fb344c171ed60eb9d2346db6ec8db7f9381a58cc9ab8034b91f17cfdf2ce74e9c67516561d959e52cfe3554c789b272381feda8bbf0c947f848cde0775b725300174fdddbcecc5eb3e762b6a9ef3718fd89917c5ec07ddf26f9387cf223be3f6627be21e3aa3baf1b59dfffa569a6bb513e1595426c956d6ab0f6d5bbe3a8a7bb8debe11327579d2632d4c0ecd5917c19bb50a2be69cc4e21ef3ddd201d184d53d115e0cc8ab34d37ac03a9efb96ff10275c2fefbe1a4e6294dd3eb256dfcd952fc4dbe859a3a3353b272ce4a6d88fe999b4906bb91a67d20e27cdaacce5431af3720e1bb0ba196cf2f9931f89d017e5be0faa9cc23048516286754bb890ed193a9a8599e8d2878d5a7f8a461b272c6351f431423ff16694bd59363de5196d70459247224a587d3f935a74dc279d2bd9d36e10bb6ef09d532d8cbc73697ef10ee37ddc52bd4d226c77ab5bc7ed20ebe6cf1755e76fa9af6631a51f3b5c70dcfecaffbfd4e54b817d694207c8d16f14d56a4b7b4ad77b8d83fdf364fdacd489d913644e7039b7c22f3b904f7766b51a47b624f08630a10293f1847b45f17958927cff2fc03a1fd9b0e6dc82302a4f7b3f71645dacc9bbbb456c333b61c53f74b56e55431fabe525b1639593b4de7d69aa709d0d863d9ecbd372a27c1dfcf2a798fecff3f24189d768bf0994aa08e594aa159e2ac30c73e1b5565beec4d89fbbea21e58e72a85eb30cb29c47f3324a9efaf19f62daa228a89627ce35e72f788cef7d60eb6bf26a29ed41afa0ab7e6cfee709c42b8e396fbbfdc1abd6122ca117ee1b0ee514f1c236d475354de31d7c22843e37a297767abc1d137a1a5ba27f62bfe0a6e69e009edc03a2d4face35333b88ef09dcc3fcc0c773b561bba7dcc1dc7ff7502738977c55c404a45bbe357352fe2df74026b8d77d4571e2ffb543403fffe3711154c890887047cdd39469b7b523757ee68d9e539ec0deb603991f84972169f1d2c675182d2ad1d15252947c2df79af55fd384f89bfd87d51e9d18e7e7c51e909cf1b9472f8bb5571eb6cc2ec5b45cb66379c4d52dc3dbb46d17e3643d1939d85b87f8965bdbd1f007c0d1078a8b7f76d804b0057cb7b7bbf056801280570ffafdede6cc0e1a929c96b93127d92366e5cb771ac337a3552352746bdcc2765ad4f546a42da2a9f17d72526015f473a9788d366429194749f8c848de9f0949eb431637dfa93cba5ae5bb71e39f3e2a18cb5ab12d626a6428b5c25a116d8e7ba8d493e89196bd6cff4f14b73754611091969493e415bfc82264f4fdd32d147b530a28f826cb43129f955bfa02989cbc6fba54df0797e40c97f97e3ca89b0f2df658ff75b3961a2cf7fccc61c364d429ca68762cf179f9ceec07f7de13fe78fffd37fce476ff0d849c05e02f611709080670878ae80170a385ec0ab04bc45c05902360fa18b87d087047c54c05705fc9d809b04dce2902f7530ed23d0e3053c7708bd7008fdca103a7e08bd6a08bd5ec05b04bc7d08bd7b086d1e42170fa10f0da18f0ea14f0da12f0ca13f1d425f4d1daccfef86d07543e8a621f4fa14819f80b70fa1770fa1cd43e8e221f4a121f4d121f4a921f405017f2ae0ba217493805b04ecb67a30ed25d03e029e31840e1b42cf1d422f1c42bf32848e17f02a01670da1b70fa1770fa1cd43e8e221f4a121f4d121f4a921f48521f4a702be2ae0a62174cb10fae1107a657a900fc6510b7dd293d6ac5fb73161634a521a4e9fecc3e74f1170b080a70a789a80a70b3884c7697dfcd21236c1740c135f4a1accc878b1e2f205be097de512362667ac495a9b9ef6c78d49e9191bd7fa6c4a48cd4872944f70949ff2bbf2030bae4c10e44b10e44b10e44b10e44b70c8d7c767f193e513f8a4097cd2043e69029f34079f19027e4ec09383043c99d7c70c473b2ff7ebd527222135356923972fd44b17eaa5f3f5de4cdab80e67cc4dd898f8ece6948d20214e421b137c7c70fa225e450989891b93d240e6b4f57cfae2f404e60d9ff5ebb8d50fe864215d9dba6e45426a7f46ba90fef2aa8d49098903d28384f427090bffc01cb87c30070ea705fd71e57adcee2025fe71e5c684354903c4406942bdc1e5104a10da8bca58cba4a7ac5bfb9fad00ca0b7c12a6fcbb7a832b8039f0e5a70a789a80a70b3844e8c79427c99786d284fa6942fd34a17e9a503fcd517f86809f13f0e420014fe6f525f04917f8a40b7cd2053e9766f07ed82c60f7e7783c5bc0c7059c28e09b3379bc53a09f0af9cf78050cf31bdc78f07a599990919aeeb332299d5935804e5d979038303f2d1dc2268e4e01134806034a599b96be3183533997be26252d4108f1fa99c1bf589ff17ea9191320d89ae933a00c6e00b4cbacdb94844d3a21ddc72f6846ea96493ea9496b67e2b86822b6e8995ce24418053e2d31213d61a6107fa5718c66fa4d4e9cb812b8a5e327ef5783d60801e090b6fe9d1c5cc7fe67823ca9f541edf72b0ffffbdff86a10fdbff1d560fa7fe3abc1f1ccffdfe22b982466054f5ea31a301dfd3923dd67dd4a9f35496bd66ddceaeacc4f238b972c8e087fe105be7cf09ab801e5d3b6a6bd9eb405f6c40c5e8f137d566cf5e176b57ea9893e9b53d257e1bd24de860e9a8f9ed06eccdab48cf5b0b8a7e3396a6b1ae68679ccf449087ade0fef7013260b780ac6638770fc7ff84fc223f190646a204192ffc34606fca3ffef1416fd1f97cc17d6d351024e15f0f5593c3e369bc73b05ec29e4fb0834582e22004800d133a08f3f1d4514800480067002900238030c03708132ae00c3014600b8a1dda2918047417d196077c01e009ef02c07f07a66371a0df01480378002600cc0d300cf00f8008c05f00550028c03f003f0070800180f30012010e00f0013019e059804f047802080c90053008201a6024c03980e10023003e039809900b30066033c0f100af027803090351ce49c03380270246015e028e8ab1a602ec03c806880f9002f00bc08b000cafc196021c04b008b400f8b01bf0c7931c02316200ee8570096002c05fa5580d70096012c87b4d701e20112005600300089004990bf1220196015400aa4ad0678032015600dc05a807500eb217f03c0468034807448cb00d804b019600b8cf056803701de02781b2013e02f6e85681b40168006201b400ba0833a2c400e801ef86d073000ec00c805d809b00be01d803c00fcdf1e8077830a9111201f9e0b00f6029800cc0085c06b1f8005a008603fc05f01de03280638005002e5de07f800e02040294019a41f02380c500ef03780ff02f810e008c0df018e42b98f008e0154001c073801e92701ac00a7003e06380d7006e02cc03980f30095001700aa003e01b8087009a01ae032400dc0a7009f015c01f81ce01f005f007c09f04f80ab005f017c0df00dc0b700d74086eb00b500df017c0f1afae19942f42f78fe11e027809f610c7e015c07e56f00dc04b001d40334003402d8019a006e01dc06b803d00c7017e01ec07d80168056805f011e00b401b403740074023c04e8027804f01b4037400fc06380de67b809609130952ce6d1b88502fd32fef3f0726fafa4a6b7d7fdff6ac77e42e328e3308e6f62d20e567a28a28387b20d2a53c16cd41e4691d2432d93127531ab8c31d2aed98549b2ee2eb3db6452420936ad63acb72283f620e261a8e221a73978e8a18731b6b1160f83c4283d94412a84e261e8a1d367b2ef369907c143538a747ff0cd67fe753b49da64de457d6800ed4743681455d02c3a83cea1efd045f42bba86d6d06df4981fc74fa1e7d02be8301a4113e8385a405fa0f3a8844ea0cfd1f7e807b48402741dfd837a7e8ce35d288bfad1ab6804b94b71eca1096c1f46c7d102fa1a2da20b6819ada0bf5084745c2f211929484506b290866ce4a0157413f5fc14c74fa0017400bd83eae8237416b9e822fa0ddd44db2ee16b876ea19d97e3783752b15d40153487cea145b48456d1a3b826846be2cfdd4623cbb82f64a159741e5d40d2cfb86f740005e29c8eed35b19d9c0fd00d94b982cf0955b13d8fbe428f63ff69b4ef4aebda768a700ac7bf4157d122f62f6d3a9ff9258ef3cbad6645c9b13d7deb2bff64398385c974764f5feb1f55eeed0696b1b9a9da74a359347379b336511ec3e2fac581175ece4d96ab2573a6597e7eba664e36eac5b1f2c6215c5e2d152bb52a364b93b9caf80758d497cb66b3d6c8d5f020526d9a33fd63994338f656e1cde1f6efc77f79de50f0e19952b2bde939c22a141b93f7ebfe9a78ed066e0e73cc2ad4ea7973bc668e37939fcb4ab68295fdd0e070e1c8e0f091d75ecf17de55b275eb60b9529c2997929b1ac2f9f78e59f98639587a3fbb37bb77fd7efb56f0ff09ed161efa7d63ff5951722cd9efde543f3afa47ab29342a7a6375633fd91e15e7473675f64f7c6fbbbabb1fc1f488e9a5d9f61fb3fd1e477ac0a39e683f37655a0f875d779f11d5e4c342af586ff4debd6e7dea27c5fa725eac77e6d3e7ffefd325dcf9d2e56ff7edfaf0fa8dd5decc8e077a479de94c673ad39987699c53e2fd37a14b7aa44f06644846a4743aad4c2aa44a6aa44e1aa445daa443baa447fa64408664444a1fa795498554498dd44983b4489b744897f4489f0cc8908c48c94e2b930aa9921aa99306699136e9902ee9913e1990211991d2276965522155522375d2202dd2261dd2253dd22703322423525a482b930aa9921aa99306699136e9902ee9913e1990211991d2a76965522155522375d2202dd2261dd2253dd22703322423523a9356261552253552270dd2226dd2215dd2237d3220433222a5cfd2caa442aaa446eaa4415aa44db627c664b670b6faf5b66adaef47c462da6f4bcc7dd9b57e7ceeeffd4f6ec5df730798129c93'
ISP_PROG = binascii.unhexlify(ISP_PROG)
ISP_PROG = zlib.decompress(ISP_PROG)

def printProgressBar (iteration, total, prefix = '', suffix = '', decimals = 1, length = 100, fill = '='):
    """
    Call in a loop to create terminal progress bar
    @params:
        iteration   - Required  : current iteration (Int)
        total       - Required  : total iterations (Int)
        prefix      - Optional  : prefix string (Str)
        suffix      - Optional  : suffix string (Str)
        decimals    - Optional  : positive number of decimals in percent complete (Int)
        length      - Optional  : character length of bar (Int)
        fill        - Optional  : bar fill character (Str)
    """
    percent = ("{0:." + str(decimals) + "f}").format(100 * (iteration / float(total)))
    filledLength = int(length * iteration // total)
    bar = fill * filledLength + '-' * (length - filledLength)
    print('\r%s |%s| %s%% %s' % (prefix, bar, percent, suffix), end = '\r')
    # Print New Line on Complete
    if iteration == total:
        print()

def slip_reader(port):
    partial_packet = None
    in_escape = False

    while True:
        waiting = port.inWaiting()
        read_bytes = port.read(1 if waiting == 0 else waiting)
        if read_bytes == b'':
            raise Exception("Timed out waiting for packet %s" % ("header" if partial_packet is None else "content"))
        for b in read_bytes:

            if type(b) is int:
                b = bytes([b])  # python 2/3 compat

            if partial_packet is None:  # waiting for packet header
                if b == b'\xc0':
                    partial_packet = b""
                else:
                    raise Exception('Invalid head of packet (%r)' % b)
            elif in_escape:  # part-way through escape sequence
                in_escape = False
                if b == b'\xdc':
                    partial_packet += b'\xc0'
                elif b == b'\xdd':
                    partial_packet += b'\xdb'
                else:
                    raise Exception('Invalid SLIP escape (%r%r)' % (b'\xdb', b))
            elif b == b'\xdb':  # start of escape sequence
                in_escape = True
            elif b == b'\xc0':  # end of packet
                yield partial_packet
                partial_packet = None
            else:  # normal byte in packet
                partial_packet += b


class ISPResponse:
    class ISPOperation(Enum):
        ISP_ECHO = 0xC1
        ISP_NOP = 0xC2
        ISP_MEMORY_WRITE = 0xC3
        ISP_MEMORY_READ = 0xC4
        ISP_MEMORY_BOOT = 0xC5
        ISP_DEBUG_INFO = 0xD1

    class ErrorCode(Enum):
        ISP_RET_DEFAULT = 0
        ISP_RET_OK = 0xE0
        ISP_RET_BAD_DATA_LEN = 0xE1
        ISP_RET_BAD_DATA_CHECKSUM = 0xE2
        ISP_RET_INVALID_COMMAND = 0xE3

    @staticmethod
    def parse(data):
        op = data[0]
        reason = data[1]
        text = ''
        try:
            if ISPResponse.ISPOperation(op) == ISPResponse.ISPOperation.ISP_DEBUG_INFO:
                text = data[2:].decode()
        except ValueError:
            print('Warning: recv unknown op', op)

        return (op, reason, text)


class FlashModeResponse:
    class Operation(Enum):
        ISP_DEBUG_INFO = 0xD1
        ISP_NOP = 0xD2
        ISP_FLASH_ERASE = 0xD3
        ISP_FLASH_WRITE = 0xD4
        ISP_REBOOT = 0xD5
        ISP_UARTHS_BAUDRATE_SET = 0xD6
        FLASHMODE_FLASH_INIT = 0xD7

    class ErrorCode(Enum):
        ISP_RET_DEFAULT = 0
        ISP_RET_OK = 0xE0
        ISP_RET_BAD_DATA_LEN = 0xE1
        ISP_RET_BAD_DATA_CHECKSUM = 0xE2
        ISP_RET_INVALID_COMMAND = 0xE3
        ISP_RET_BAD_INITIALIZATION = 0xE4

    @staticmethod
    def parse(data):
        op = data[0]
        reason = data[1]
        text = ''
        if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.ISP_DEBUG_INFO:
            text = data[2:].decode()

        return (op, reason, text)


def chunks(l, n):
    """Yield successive n-sized chunks from l."""
    for i in range(0, len(l), n):
        yield l[i:i + n]


class MAIXLoader:
    def change_baudrate(self, baudrate):
        print(INFO_MSG,"Selected Baudrate: ", baudrate, BASH_TIPS['DEFAULT'])
        out = struct.pack('III', 0, 4, baudrate)
        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)
        out = struct.pack('HH', 0xd6, 0x00) + crc32_checksum + out
        self.write(out)
        time.sleep(0.05)
        self._port.baudrate = baudrate

    def __init__(self, port='/dev/ttyUSB1', baudrate=115200):
        # configure the serial connections (the parameters differs on the device you are connecting to)
        self._port = serial.Serial(
            port=port,
            baudrate=baudrate,
            parity=serial.PARITY_NONE,
            stopbits=serial.STOPBITS_ONE,
            bytesize=serial.EIGHTBITS,
            timeout=0.1
        )
        print(INFO_MSG, "Default baudrate is", baudrate, ", later it may be changed to the value you set.",  BASH_TIPS['DEFAULT'])

        self._port.isOpen()
        self._slip_reader = slip_reader(self._port)

    """ Read a SLIP packet from the serial port """

    def read(self):
        return next(self._slip_reader)

    """ Write bytes to the serial port while performing SLIP escaping """

    def write(self, packet):
        buf = b'\xc0' \
              + (packet.replace(b'\xdb', b'\xdb\xdd').replace(b'\xc0', b'\xdb\xdc')) \
              + b'\xc0'
        #print('[WRITE]', binascii.hexlify(buf))
        return self._port.write(buf)

    def read_loop(self):
        out = b''
        # while self._port.inWaiting() > 0:
        #     out += self._port.read(1)

        # print(out)
        while 1:
            sys.stdout.write('[RECV] raw data: ')
            sys.stdout.write(binascii.hexlify(self._port.read(1)).decode())
            sys.stdout.flush()

    def recv_one_return(self):
        timeout_init = time.time()
        data = b''
        # find start boarder
        #sys.stdout.write('[RECV one return] raw data: ')
        while 1:
            if time.time() - timeout_init > timeout:
                print(ERROR_MSG,'Response timeout',BASH_TIPS['DEFAULT'])
                raise TimeoutError
            c = self._port.read(1)
            #sys.stdout.write(binascii.hexlify(c).decode())
            sys.stdout.flush()
            if c == b'\xc0':
                break

        in_escape = False
        while 1:
            if time.time() - timeout_init > timeout:
                raise TimeoutError
            c = self._port.read(1)
            #sys.stdout.write(binascii.hexlify(c).decode())
            sys.stdout.flush()
            if c == b'\xc0':
                break

            elif in_escape:  # part-way through escape sequence
                in_escape = False
                if c == b'\xdc':
                    data += b'\xc0'
                elif c == b'\xdd':
                    data += b'\xdb'
                else:
                    raise Exception('Invalid SLIP escape (%r%r)' % (b'\xdb', b))
            elif c == b'\xdb':  # start of escape sequence
                in_escape = True

            data += c

        #sys.stdout.write('\n')
        return data

    # kd233 or open-ec or new cmsis-dap
    def reset_to_isp_kd233(self):
        self._port.dtr = False
        self._port.rts = False
        time.sleep(0.1)
        #print('-- RESET to LOW, IO16 to HIGH --')
        # Pull reset down and keep 10ms
        self._port.dtr = True
        self._port.rts = False
        time.sleep(0.1)
        #print('-- IO16 to LOW, RESET to HIGH --')
        # Pull IO16 to low and release reset
        self._port.rts = True
        self._port.dtr = False
        time.sleep(0.1)
    def reset_to_boot_kd233(self):
        self._port.dtr = False
        self._port.rts = False
        time.sleep(0.1)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.dtr = True
        self._port.rts = False
        time.sleep(0.1)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.rts = False
        self._port.dtr = False
        time.sleep(0.1)

    #dan dock
    def reset_to_isp_dan(self):
        self._port.dtr = False
        self._port.rts = False
        time.sleep(0.1)
        #print('-- RESET to LOW, IO16 to HIGH --')
        # Pull reset down and keep 10ms
        self._port.dtr = False
        self._port.rts = True
        time.sleep(0.1)
        #print('-- IO16 to LOW, RESET to HIGH --')
        # Pull IO16 to low and release reset
        self._port.rts = False
        self._port.dtr = True
        time.sleep(0.1)
    def reset_to_boot_dan(self):
        self._port.dtr = False
        self._port.rts = False
        time.sleep(0.1)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.dtr = False
        self._port.rts = True
        time.sleep(0.1)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.rts = False
        self._port.dtr = False
        time.sleep(0.1)

    # maix go for old cmsis-dap firmware
    def reset_to_isp_goD(self):
        self._port.setDTR (True)   ## output 0
        self._port.setRTS (True)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
    def reset_to_boot_goD(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (True)
        self._port.setDTR (True)
        time.sleep(0.01)

    # maix go for openec or new cmsis-dap  firmware
    def reset_to_boot_maixgo(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (False)
        time.sleep(0.01)

    def greeting(self):
        self._port.write(b'\xc0\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
        op, reason, text = ISPResponse.parse(self.recv_one_return())

        #print('MAIX return op:', ISPResponse.ISPOperation(op).name, 'reason:', ISPResponse.ErrorCode(reason).name)


    def flash_greeting(self):
        retry_count = 0
        while 1:
            self._port.write(b'\xc0\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
            retry_count = retry_count + 1
            try:
                op, reason, text = FlashModeResponse.parse(self.recv_one_return())
            except IndexError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Index Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except TimeoutError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Timeout Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            # print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
            #      FlashModeResponse.ErrorCode(reason).name)
            if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.ISP_NOP and FlashModeResponse.ErrorCode(reason) == FlashModeResponse.ErrorCode.ISP_RET_OK:
                print(INFO_MSG,"Boot to Flashmode Successfully",BASH_TIPS['DEFAULT'])
                self._port.flushInput()
                self._port.flushOutput()
                break
            else:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Return recevied, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue

    def boot(self, address=0x80000000):
        print(INFO_MSG,"Booting From " + hex(address),BASH_TIPS['DEFAULT'])

        out = struct.pack('II', address, 0)

        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)

        out = struct.pack('HH', 0xc5, 0x00) + crc32_checksum + out  # op: ISP_MEMORY_WRITE: 0xc3
        self.write(out)

    def recv_debug(self):
        op, reason, text = ISPResponse.parse(self.recv_one_return())
        #print('[RECV] op:', ISPResponse.ISPOperation(op).name, 'reason:', ISPResponse.ErrorCode(reason).name)
        if text:
            print('-' * 30)
            print(text)
            print('-' * 30)
        if ISPResponse.ErrorCode(reason) not in (ISPResponse.ErrorCode.ISP_RET_DEFAULT, ISPResponse.ErrorCode.ISP_RET_OK):
            print('Failed, retry, errcode=', hex(reason))
            return False
        return True

    def flash_recv_debug(self):
        op, reason, text = FlashModeResponse.parse(self.recv_one_return())
        #print('[Flash-RECV] op:', FlashModeResponse.Operation(op).name, 'reason:',
        #      FlashModeResponse.ErrorCode(reason).name)
        if text:
            print('-' * 30)
            print(text)
            print('-' * 30)

        if FlashModeResponse.ErrorCode(reason) not in (FlashModeResponse.ErrorCode.ISP_RET_OK, FlashModeResponse.ErrorCode.ISP_RET_OK):
            print('Failed, retry')
            return False
        return True

    def init_flash(self, chip_type):
        chip_type = int(chip_type)
        print(INFO_MSG,"Selected Flash: ",("In-Chip", "On-Board")[chip_type],BASH_TIPS['DEFAULT'])
        out = struct.pack('II', chip_type, 0)
        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)
        out = struct.pack('HH', 0xd7, 0x00) + crc32_checksum + out
        '''Retry when it have error'''
        retry_count = 0
        while 1:
            sent = self.write(out)
            retry_count = retry_count + 1
            try:
                op, reason, text = FlashModeResponse.parse(self.recv_one_return())
            except IndexError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Index Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except TimeoutError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Timeout Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            # print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
            #      FlashModeResponse.ErrorCode(reason).name)
            if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.FLASHMODE_FLASH_INIT and FlashModeResponse.ErrorCode(reason) == FlashModeResponse.ErrorCode.ISP_RET_OK:
                print(INFO_MSG,"Initialization flash Successfully",BASH_TIPS['DEFAULT'])
                break
            else:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Return recevied, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue

    def flash_dataframe(self, data, address=0x80000000):
        DATAFRAME_SIZE = 1024
        data_chunks = chunks(data, DATAFRAME_SIZE)
        #print('[DEBUG] flash dataframe | data length:', len(data))
        total_chunk = math.ceil(len(data)/DATAFRAME_SIZE)

        time_start = time.time()
        for n, chunk in enumerate(data_chunks):
            while 1:
                #print('[INFO] sending chunk', i, '@address', hex(address), 'chunklen', len(chunk))
                out = struct.pack('II', address, len(chunk))

                crc32_checksum = struct.pack('I', binascii.crc32(out + chunk) & 0xFFFFFFFF)

                out = struct.pack('HH', 0xc3, 0x00) + crc32_checksum + out + chunk  # op: ISP_MEMORY_WRITE: 0xc3
                sent = self.write(out)
                #print('[INFO]', 'sent', sent, 'bytes', 'checksum', binascii.hexlify(crc32_checksum).decode())

                address += len(chunk)

                if self.recv_debug():
                    break

            columns, lines = os.get_terminal_size()
            time_delta = time.time() - time_start
            speed = ''
            if (time_delta > 1):
                speed = str(int((n + 1) * DATAFRAME_SIZE / 1024.0 / time_delta)) + 'kiB/s'
            printProgressBar(n+1, total_chunk, prefix = 'Downloading ISP:', suffix = speed, length = columns - 35)

    def dump_to_flash(self, data, address=0):
        '''
        typedef struct __attribute__((packed)) {
            uint8_t op;
            int32_t checksum; // 下面的所有字段都要参与checksum的计算
            uint32_t address;
            uint32_t data_len;
            uint8_t data_buf[1024];
        } isp_request_t;
        '''

        DATAFRAME_SIZE = 4096
        data_chunks = chunks(data, DATAFRAME_SIZE)
        #print('[DEBUG] flash dataframe | data length:', len(data))



        for n, chunk in enumerate(data_chunks):
            #print('[INFO] sending chunk', i, '@address', hex(address))
            out = struct.pack('II', address, len(chunk))

            crc32_checksum = struct.pack('I', binascii.crc32(out + chunk) & 0xFFFFFFFF)

            out = struct.pack('HH', 0xd4, 0x00) + crc32_checksum + out + chunk
            #print("[$$$$]", binascii.hexlify(out[:32]).decode())
            retry_count = 0
            while True:
                try:
                    sent = self.write(out)
                    #print('[INFO]', 'sent', sent, 'bytes', 'checksum', crc32_checksum)
                    self.flash_recv_debug()
                except:
                    retry_count = retry_count + 1
                    if retry_count > MAX_RETRY_TIMES:
                        print(ERROR_MSG,"Error Count Exceeded, Stop Trying",BASH_TIPS['DEFAULT'])
                        sys.exit(1)
                    continue
                break
            address += len(chunk)



    def flash_erase(self):
        #print('[DEBUG] erasing spi flash.')
        self._port.write(b'\xc0\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
        op, reason, text = FlashModeResponse.parse(self.recv_one_return())
        #print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
        #      FlashModeResponse.ErrorCode(reason).name)

    def install_flash_bootloader(self, data):
        # 1. 刷入 flash bootloader
        self.flash_dataframe(data, address=0x80000000)

    def flash_firmware(self, firmware_bin: bytes, aes_key: bytes = None, address_offset = 0, sha256Prefix = True):
        #print('[DEBUG] flash_firmware DEBUG: aeskey=', aes_key)

        if sha256Prefix == True:
            # 固件加上头
            # 格式: SHA256(after)(32bytes) + AES_CIPHER_FLAG (1byte) + firmware_size(4bytes) + firmware_data
            aes_cipher_flag = b'\x01' if aes_key else b'\x00'

            # 加密
            if aes_key:
                enc = AES_128_CBC(aes_key, iv=b'\x00'*16).encrypt
                padded = firmware_bin + b'\x00'*15 # zero pad
                firmware_bin = b''.join([enc(padded[i*16:i*16+16]) for i in range(len(padded)//16)])

            firmware_len = len(firmware_bin)

            data = aes_cipher_flag + struct.pack('I', firmware_len) + firmware_bin

            sha256_hash = hashlib.sha256(data).digest()

            firmware_with_header = data + sha256_hash

            total_chunk = math.ceil(len(firmware_with_header)/4096)
            # 3. 分片刷入固件
            data_chunks = chunks(firmware_with_header, 4096)  # 4kb for a sector
        else:
            total_chunk = math.ceil(len(firmware_bin)/4096)
            data_chunks = chunks(firmware_bin, 4096)

        time_start = time.time()
        for n, chunk in enumerate(data_chunks):
            chunk = chunk.ljust(4096, b'\x00')  # align by 4kb

            # 3.1 刷入一个dataframe
            #print('[INFO]', 'Write firmware data piece')
            self.dump_to_flash(chunk, address= n * 4096 + address_offset)
            columns, lines = os.get_terminal_size()
            time_delta = time.time() - time_start
            speed = ''
            if (time_delta > 1):
                speed = str(int((n + 1) * 4096 / 1024.0 / time_delta)) + 'kiB/s'
            printProgressBar(n+1, total_chunk, prefix = 'Programming BIN:', suffix = speed, length = columns - 35)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument("-p", "--port", help="COM Port", default="DEFAULT")
    parser.add_argument("-c", "--chip", help="SPI Flash type, 0 for in-chip, 1 for on-board", default=1)
    parser.add_argument("-b", "--baudrate", type=int, help="UART baudrate for uploading firmware", default=115200)
    parser.add_argument("-l", "--bootloader", help="bootloader bin path", required=False, default=None)
    parser.add_argument("-k", "--key", help="AES key in hex, if you need encrypt your firmware.", required=False, default=None)
    parser.add_argument("-v", "--verbose", help="increase output verbosity", default=False, action="store_true")
    parser.add_argument("-t", "--terminal", help="Start a terminal after finish (Python miniterm)", default=False, action="store_true")
    parser.add_argument("-n", "--noansi", help="Do not use ANSI colors, recommended in Windows CMD", default=False, action="store_true")
    parser.add_argument("-s", "--sram", help="Download firmware to SRAM and boot", default=False, action="store_true")

    parser.add_argument("-B", "--Board",required=True, type=str, help="Select dev board, kd233 or dan or bit or goD or goE")
    parser.add_argument("firmware", help="firmware bin path")

    args = parser.parse_args()

    if (args.noansi == True):
        BASH_TIPS = dict(NORMAL='',BOLD='',DIM='',UNDERLINE='',
                            DEFAULT='', RED='', YELLOW='', GREEN='',
                            BG_DEFAULT='', BG_WHITE='')
        ERROR_MSG   = BASH_TIPS['RED']+BASH_TIPS['BOLD']+'[ERROR]'+BASH_TIPS['NORMAL']
        WARN_MSG    = BASH_TIPS['YELLOW']+BASH_TIPS['BOLD']+'[WARN]'+BASH_TIPS['NORMAL']
        INFO_MSG    = BASH_TIPS['GREEN']+BASH_TIPS['BOLD']+'[INFO]'+BASH_TIPS['NORMAL']
        print(INFO_MSG,'ANSI colors not used',BASH_TIPS['DEFAULT'])

    if args.port == "DEFAULT":
        if args.Board == "goE":
            list_port_info = list(serial.tools.list_ports.grep("0403")) #Take the second one
            if(len(list_port_info)==0):
                print(ERROR_MSG,"No vaild COM Port found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`--port/-p`',BASH_TIPS['DEFAULT'])
                sys.exit(1)
            list_port_info.sort()
            print(INFO_MSG,"COM Port Auto Detected, Selected ",list_port_info[1].device,BASH_TIPS['DEFAULT'])
            _port = list_port_info[1].device
        else:
            try:
                list_port_info = next(serial.tools.list_ports.grep(VID_LIST_FOR_AUTO_LOOKUP)) #Take the first one within the list
                _port = list_port_info.device
            except StopIteration:
                print(ERROR_MSG,"No vaild COM Port found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`--port/-p`',BASH_TIPS['DEFAULT'])
                sys.exit(1)
    else:
        _port = args.port
        print(INFO_MSG,"COM Port Selected Manually: ",_port,BASH_TIPS['DEFAULT'])

    loader = MAIXLoader(port=_port, baudrate=115200)

    # 0. Check firmware
    try:
        firmware_bin = open(args.firmware, 'rb')
    except FileNotFoundError:
        print(ERROR_MSG,'Unable to find the firmware at ', args.firmware, BASH_TIPS['DEFAULT'])
        sys.exit(1)

    with open(args.firmware, 'rb') as f:
        file_header = f.read(4)
        if file_header.startswith(bytes([0x50, 0x4B])):
            if ".kfpkg" != os.path.splitext(args.firmware)[1]:
                print(INFO_MSG, 'Find a zip file, but not with ext .kfpkg:', args.firmware, BASH_TIPS['DEFAULT'])
        if file_header.startswith(bytes([0x7F, 0x45, 0x4C, 0x46])):
            print(ERROR_MSG, 'This is an ELF file and cannot be programmed directly:', args.firmware, BASH_TIPS['DEFAULT'])
            print(ERROR_MSG, 'Please retry:', args.firmware + '.bin', BASH_TIPS['DEFAULT'])
            sys.exit(1)

    # 1. Greeting.
    print(INFO_MSG,"Trying to Enter the ISP Mode...",BASH_TIPS['DEFAULT'])

    retry_count = 0

    while 1:
        retry_count = retry_count + 1
        if retry_count > 15:
            print("\n" + ERROR_MSG,"No vaild Kendryte K210 found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`-p '+('/dev/ttyUSB0', 'COM3')[sys.platform == 'win32']+'`',BASH_TIPS['DEFAULT'])
            sys.exit(1)
        if args.Board == "dan" or args.Board == "bit":
            try:
                print('.', end='')
                loader.reset_to_isp_dan()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "kd233":
            try:
                print('_', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "goE":
            try:
                print('*', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "goD":
            try:
                print('#', end='')
                loader.reset_to_isp_goD()
                loader.greeting()
                break
            except TimeoutError:
                pass
        else:
            print(ERROR_MSG,"Board unknown!!")
            sys.exit(1)
    timeout = 3
    print()
    print(INFO_MSG,"Greeting Message Detected, Start Downloading ISP",BASH_TIPS['DEFAULT'])
    # 2. flash bootloader and firmware

    # install bootloader at 0x80000000
    isp_loader = open(args.bootloader, 'rb').read() if args.bootloader else ISP_PROG

    if args.sram:
        if ".kfpkg" == os.path.splitext(args.firmware)[1]:
            print(ERROR_MSG, "Unable to load kfpkg to SRAM")
            sys.exit(1)
        isp_loader = firmware_bin.read()

    loader.install_flash_bootloader(isp_loader)
    loader.boot()

    if args.sram:
        if(args.terminal == True):
            import serial.tools.miniterm
            _miniterm = serial.tools.miniterm.Miniterm(loader._port)
            _miniterm.set_rx_encoding('UTF-8')
            _miniterm.set_tx_encoding('UTF-8')
            _miniterm.start()
            try:
                _miniterm.join(True)
            except KeyboardInterrupt:
                pass
            _miniterm.join()
            _miniterm.close()
            sys.exit(0)

    print(INFO_MSG,"Wait For 0.1 second for ISP to Boot", BASH_TIPS['DEFAULT'])

    time.sleep(0.1)

    loader.flash_greeting()

    if args.baudrate != 115200:
        loader.change_baudrate(args.baudrate)
        print(INFO_MSG,"Baudrate changed, greeting with ISP again ... ", BASH_TIPS['DEFAULT'])
        loader.flash_greeting()

    loader.init_flash(args.chip)

    if ".kfpkg" == os.path.splitext(args.firmware)[1]:
        print(INFO_MSG,"Extracting KFPKG ... ", BASH_TIPS['DEFAULT'])
        firmware_bin.close()
        with tempfile.TemporaryDirectory() as tmpdir:
            try:
                with zipfile.ZipFile(args.firmware) as zf:
                    zf.extractall(tmpdir)
            except zipfile.BadZipFile:
                print(ERROR_MSG,'Unable to Decompress the kfpkg, your file might be corrupted.',BASH_TIPS['DEFAULT'])
                sys.exit(1)

            fFlashList = open(os.path.join(tmpdir, 'flash-list.json'), "r")
            sFlashList = re.sub(r'"address": (.*),', r'"address": "\1",', fFlashList.read()) #Pack the Hex Number in json into str
            fFlashList.close()
            jsonFlashList = json.loads(sFlashList)
            for lBinFiles in jsonFlashList['files']:
                print(INFO_MSG,"Writing",lBinFiles['bin'],"into","0x%08x"%int(lBinFiles['address'], 0),BASH_TIPS['DEFAULT'])
                firmware_bin = open(os.path.join(tmpdir, lBinFiles["bin"]), "rb")
                loader.flash_firmware(firmware_bin.read(), None, int(lBinFiles['address'], 0), lBinFiles['sha256Prefix'])
                firmware_bin.close()
    else:
        if args.key:
            aes_key = binascii.a2b_hex(args.key)
            if len(aes_key) != 16:
                raise ValueError('AES key must by 16 bytes')

            loader.flash_firmware(firmware_bin.read(), aes_key=aes_key)
        else:
            loader.flash_firmware(firmware_bin.read())

    # 3. boot
    if args.Board == "dan" or args.Board == "bit":
        loader.reset_to_boot_dan()
    elif args.Board == "kd233":
        loader.reset_to_boot_kd233()
    elif args.Board == "goE":
        loader.reset_to_boot_maixgo()
    elif args.Board == "goD":
        loader.reset_to_boot_goD()
    else:
        print(ERROR_MSG,"Board unknown !! please press reset to boot!!")

    print(INFO_MSG,"Rebooting...", BASH_TIPS['DEFAULT'])
    loader._port.close()

    if(args.terminal == True):
        import serial.tools.miniterm
        # For using the terminal with MaixPy the 'filter' option must be set to 'direct'
        # because some control characters are emited
        sys.argv = ['kflash.py', _port, '115200', '--dtr=0', '--rts=0',  '--filter=direct']
        serial.tools.miniterm.main(default_port=_port, default_baudrate=115200, default_dtr=False, default_rts=False)
        sys.exit(0)
